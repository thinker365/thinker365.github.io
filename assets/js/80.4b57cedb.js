(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{604:function(e,s,n){"use strict";n.r(s);var a=n(35),t=Object(a.a)({},(function(){var e=this,s=e.$createElement,n=e._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("p"),n("div",{staticClass:"table-of-contents"},[n("ul",[n("li",[n("a",{attrs:{href:"#安装环境"}},[e._v("安装环境")])])])]),n("p"),e._v(" "),n("h2",{attrs:{id:"安装环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装环境"}},[e._v("#")]),e._v(" 安装环境")]),e._v(" "),n("p",[e._v("以Linux平台为例，已安装docker，并启动")]),e._v(" "),n("ol",[n("li",[e._v("minikube下载安装"),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("$ curl -LO https://github.com/kubernetes/minikube/releases/download/v1.13.1/minikube-linux-amd64\n很慢可以通过以下方式\ncurl -LO https://githubfast.com/kubernetes/minikube/releases/download/v1.13.1/minikube-linux-amd64\n$ sudo install minikube-linux-amd64 /usr/local/bin/minikube\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br")])])]),e._v(" "),n("li",[e._v("kubectl下载安装\n"),n("ul",[n("li",[e._v("方式一")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("- [https://kubernetes.io/releases/download/](https://kubernetes.io/releases/download/)\n- [https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/](https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/)\n$ curl -LO https://dl.k8s.io/v1.19.2/kubernetes-client-linux-amd64.tar.gz\n$ tar -xvf kubernetes-client-linux-amd64.tar.gz\n$ sudo install kubernetes/client/bin/kubectl /usr/local/bin/kubectl\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("ul",[n("li",[e._v("方式二")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('ubuntu@VM-12-15-ubuntu:~/k8s$ curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl"\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\n100   138  100   138    0     0    115      0  0:00:01  0:00:01 --:--:--   115\n100 45.7M  100 45.7M    0     0  4463k      0  0:00:10  0:00:10 --:--:-- 5760k\n\nubuntu@VM-12-15-ubuntu:~/k8s$ curl -LO "https://dl.k8s.io/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl.sha256"\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n100   138  100   138    0     0     36      0  0:00:03  0:00:03 --:--:--    36\n100    64  100    64    0     0     10      0  0:00:06  0:00:05  0:00:01    36\n\nubuntu@VM-12-15-ubuntu:~/k8s$ echo "$(cat kubectl.sha256)  kubectl" | sha256sum --check\nkubectl: OK\n\nubuntu@VM-12-15-ubuntu:~/k8s$ sudo install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl\n\nubuntu@VM-12-15-ubuntu:~/k8s$ kubectl version --client\nWARNING: This version information is deprecated and will be replaced with the output from kubectl version --short.  Use --output=yaml|json to get the full version.\nClient Version: version.Info{Major:"1", Minor:"26", GitVersion:"v1.26.0", GitCommit:"b46a3f887ca979b1a5d14fd39cb1af43e7e5d12d", GitTreeState:"clean", BuildDate:"2022-12-08T19:58:30Z", GoVersion:"go1.19.4", Compiler:"gc", Platform:"linux/amd64"}\nKustomize Version: v4.5.7\n\nubuntu@VM-12-15-ubuntu:~/k8s$ kubectl version --client --output=yaml\nclientVersion:\n  buildDate: "2022-12-08T19:58:30Z"\n  compiler: gc\n  gitCommit: b46a3f887ca979b1a5d14fd39cb1af43e7e5d12d\n  gitTreeState: clean\n  gitVersion: v1.26.0\n  goVersion: go1.19.4\n  major: "1"\n  minor: "26"\n  platform: linux/amd64\nkustomizeVersion: v4.5.7\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br"),n("span",{staticClass:"line-number"},[e._v("20")]),n("br"),n("span",{staticClass:"line-number"},[e._v("21")]),n("br"),n("span",{staticClass:"line-number"},[e._v("22")]),n("br"),n("span",{staticClass:"line-number"},[e._v("23")]),n("br"),n("span",{staticClass:"line-number"},[e._v("24")]),n("br"),n("span",{staticClass:"line-number"},[e._v("25")]),n("br"),n("span",{staticClass:"line-number"},[e._v("26")]),n("br"),n("span",{staticClass:"line-number"},[e._v("27")]),n("br"),n("span",{staticClass:"line-number"},[e._v("28")]),n("br"),n("span",{staticClass:"line-number"},[e._v("29")]),n("br"),n("span",{staticClass:"line-number"},[e._v("30")]),n("br"),n("span",{staticClass:"line-number"},[e._v("31")]),n("br"),n("span",{staticClass:"line-number"},[e._v("32")]),n("br"),n("span",{staticClass:"line-number"},[e._v("33")]),n("br"),n("span",{staticClass:"line-number"},[e._v("34")]),n("br"),n("span",{staticClass:"line-number"},[e._v("35")]),n("br")])])])]),e._v(" "),n("p",[e._v("kubectl port-forward 转发端口\nport: 是k8s集群内部访问service的端口，即通过clusterIP: port可以访问到某个service\nnodePort: 是外部访问k8s集群中service的端口，通过nodeIP: nodePort可以从外部访问到某个service\ntargetPort: 是pod的端口，从port和nodePort来的流量经过kube-proxy流入到后端pod的targetPort上，最后进入容器\ncontainerPort: 是pod内部容器的端口，targetPort映射到containerPort")]),e._v(" "),n("p",[e._v("useradd --r -m -s /bin/bash minikube\npasswd minikube\nadduser minikube sudo#给用户添加管理员权限\ngroupadd docker\nusermod -aG docker minikube\nnewgrp docker")]),e._v(" "),n("p",[e._v("apt install apt-transport-https\ncurl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add -\n#设置源\ncat <"),n("EOF",[e._v("/etc/apt/sources.list.d/kubernetes.list\ndeb https://mirrors.aliyun.com/kubernetes/apt/  kubernetes-xenial main\nEOF\n#下载k8s需要的工具\napt install kubelet kubeadm kubectl")])],1),e._v(" "),n("ol",{attrs:{start:"4"}},[n("li",[e._v("Kubernetes集群安装"),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("sudo minikube start --driver=docker --container-runtime=containerd --image-repository='registry.cn-hangzhou.aliyuncs.com/google_containers'  --force\nminikube start --driver=vmware --memory=2048 --cpus=2 --image-repository='registry.cn-hangzhou.aliyuncs.com/google_containers'\n\nroot@knownsec-virtual-machine:/home/knownsec/k8s# minikube start\n😄  minikube v1.13.1 on Ubuntu 20.04\n✨  Automatically selected the docker driver\n🛑  The \"docker\" driver should not be used with root privileges.\n💡  If you are running minikube within a VM, consider using --driver=none:\n📘    https://minikube.sigs.k8s.io/docs/reference/drivers/none/\n\n❌  Exiting due to DRV_AS_ROOT: The \"docker\" driver should not be used with root privileges.\n\nroot@knownsec-virtual-machine:/home/knownsec/k8s# minikube start --force --driver=docker\n\n慢慢等，时间稍微有点久～～\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br")])])]),e._v(" "),n("li",[e._v("检查集群状态"),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("root@knownsec-virtual-machine:/home/knownsec/k8s# kubectl cluster-info\nKubernetes master is running at https://172.17.0.4:8443\nKubeDNS is running at https://172.17.0.4:8443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy\n\nTo further debug and diagnose cluster problems, use 'kubectl cluster-info dump'.\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])])]),e._v(" "),n("li",[e._v("创建第一个应用\n创建文件vim deployment.yaml，发布部署文件到 Kubernetes 集群，格式参考："),n("a",{attrs:{href:"https://kubernetes.io/docs/concepts/workloads/controllers/deployment/",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://kubernetes.io/docs/concepts/workloads/controllers/deployment/"),n("OutboundLink")],1)])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("kubectl create -f deployment.yaml --validate=false\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br")])]),n("p",[e._v("查看一下Pod是否被成功启动")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("thinker@Thinker .k8s % kubectl get pod -o wide\nNAME                               READY   STATUS             RESTARTS   AGE     IP           NODE       NOMINATED NODE   READINESS GATES\nnginx-deployment-9456bbbf9-657fd   0/1     ImagePullBackOff   0          2m39s   172.17.0.5   minikube   <none>           <none>\nnginx-deployment-9456bbbf9-bblxg   0/1     ImagePullBackOff   0          2m39s   172.17.0.6   minikube   <none>           <none>\nnginx-deployment-9456bbbf9-fgw9k   0/1     ImagePullBackOff   0          2m39s   172.17.0.7   minikube   <none>           <none>\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("p",[e._v("创建 service.yaml 文件，将服务暴露出去")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("kubectl create -f service.yaml --validate=false\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br")])]),n("p",[e._v("创建完成后，Kubernetes 会随机帮助我们分配一个外部访问端口")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("kubectl get service -o wide\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br")])]),n("p",[e._v("由于我们的集群使用 minikube 安装，要想集群中的服务可以通过外部访问，还需要执行以下命令")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("minikube service hello-world\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br")])]),n("ul",[n("li",[e._v("jenkins k8s")])]),e._v(" "),n("ol",[n("li",[e._v("docker更换阿里镜像源")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors\n\n配置镜像加速器\n您可以通过修改daemon配置文件/etc/docker/daemon.json来使用加速器\nsudo mkdir -p /etc/docker\nsudo tee /etc/docker/daemon.json\n{\n  "registry-mirrors": ["https://yf2c7vcr.mirror.aliyuncs.com"]\n}\n\nsudo systemctl daemon-reload\nsudo systemctl restart docker\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br")])]),n("ol",{attrs:{start:"2"}},[n("li",[e._v("部署Jenkins环境")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("docker search jenkins\ndocker pull jenkins/jenkins\nubuntu@VM-12-15-ubuntu:/home$ sudo mkdir jenkins\nubuntu@VM-12-15-ubuntu:/home$ sudo chmod 777 jenkins/\ndocker run -d -uroot -p 8088:8080 -p 50000:50000 --name jenkins -v /home/jenkins:/var/jenkins_home -v /etc/localtime:/etc/localtime  jenkins/jenkins\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("p",[e._v("因网络原因，jenkins插件下载慢，可进入宿主机目录 /home/jenkins_home/，编辑文件 hudson.model.UpdateCenter.xml")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("sudo chmod 777 hudson.model.UpdateCenter.xml \n将 url 内容修改为 https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json（清华大学官方镜像）\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("p",[e._v("或者换阿里源")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("https://developer.aliyun.com/mirror/?serviceType=&tag=&keyword=jenkins\n进入updates/目录\n查看update-center.json\n复制打开页面链接https://mirrors.aliyun.com/jenkins/updates/update-center.json?spm=a2c6h.25603864.0.0.2397597ayN97Ig\n后面参数去掉，留下https://mirrors.aliyun.com/jenkins/updates/update-center.json\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("p",[e._v("重启Jenkins")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("docker restart jenkins\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br")])]),n("p",[e._v("输入密码进入jerkins页面")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("docker logs 45f6ffc17df2f5655d02db3da28e69d271ade984628cdb97691b9dd9de8c6663\n5c482721bc1048ce8cc6918af566a4e8\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br")])]),n("p",[e._v("http://175.178.125.91:8088/\n输入初始的管理员密码，根据提示密码在/var/jenkins_home/secrets/initialAdminPassword这个文件中\n可执行 docker exec jenkins cat /var/jenkins_home/secrets/initialAdminPassword获取\n安装推荐的插件\n设置管理员账号\nlinyuan admin@123")]),e._v(" "),n("p",[e._v("ref: https://blog.csdn.net/BThinker/article/details/124178670\n2.  安装minikube，kubectl")]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("https://minikube.sigs.k8s.io/docs/start/\ncurl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64\nsudo install minikube-linux-amd64 /usr/local/bin/minikube\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br")])]),n("ol",{attrs:{start:"3"}},[n("li",[e._v("启动集群")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('minikube start --image-repository=\'registry.cn-hangzhou.aliyuncs.com/google_containers\'  --image-mirror-country=cn  --kubernetes-version=v1.23.8  --registry-mirror=https://yf2c7vcr.mirror.aliyuncs.com\n\nminikube start --image-repository=\'registry.cn-hangzhou.aliyuncs.com/google_containers\'  --image-mirror-country=cn  --kubernetes-version=v1.23.8\n\nminikube start  --image-mirror-country=cn  --kubernetes-version=v1.23.8\n\nkubectl port-forward service/hello-minikube 10000:8080\n\nkubectl proxy --port=10000 --address="10.0.12.15 " --accept-hosts="^.*"\n\nminikube service  hello-minikube-fdf664d87-44jcl  --url\n\nkubectl expose deployment hello-minikube1 --type=LoadBalancer --port=8088\n\n😄  minikube v1.28.0 on Darwin 13.0 (arm64)\n🆕  Kubernetes 1.25.3 is now available. If you would like to upgrade, specify: --kubernetes-version=v1.25.3\n✨  Using the docker driver based on existing profile\n👍  Starting control plane node minikube in cluster minikube\n🚜  Pulling base image ...\n    > registry.cn-hangzhou.aliyun...:  0 B [___________________] ?% ? p/s 3m18s\n❗  minikube was unable to download registry.cn-hangzhou.aliyuncs.com/google_containers/kicbase:v0.0.36, but successfully downloaded registry.cn-hangzhou.aliyuncs.com/google_containers/kicbase:v0.0.36 as a fallback image\n🔥  Creating docker container (CPUs=2, Memory=4000MB) ...\n❗  This container is having trouble accessing https://registry.cn-hangzhou.aliyuncs.com/google_containers\n💡  To pull new external images, you may need to configure a proxy: https://minikube.sigs.k8s.io/docs/reference/networking/proxy/\n🐳  Preparing Kubernetes v1.23.8 on Docker 20.10.20 ...\n    ▪ Generating certificates and keys ...\n    ▪ Booting up control plane ...\n    ▪ Configuring RBAC rules ...\n🔎  Verifying Kubernetes components...\n    ▪ Using image registry.cn-hangzhou.aliyuncs.com/google_containers/storage-provisioner:v5\n🌟  Enabled addons: storage-provisioner, default-storageclass\n\n❗  /opt/homebrew/bin/kubectl is version 1.25.4, which may have incompatibilities with Kubernetes 1.23.8.\n    ▪ Want kubectl v1.23.8? Try \'minikube kubectl -- get pods -A\'\n🏄  Done! kubectl is now configured to use "minikube" cluster and "default" namespace by default\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br"),n("span",{staticClass:"line-number"},[e._v("20")]),n("br"),n("span",{staticClass:"line-number"},[e._v("21")]),n("br"),n("span",{staticClass:"line-number"},[e._v("22")]),n("br"),n("span",{staticClass:"line-number"},[e._v("23")]),n("br"),n("span",{staticClass:"line-number"},[e._v("24")]),n("br"),n("span",{staticClass:"line-number"},[e._v("25")]),n("br"),n("span",{staticClass:"line-number"},[e._v("26")]),n("br"),n("span",{staticClass:"line-number"},[e._v("27")]),n("br"),n("span",{staticClass:"line-number"},[e._v("28")]),n("br"),n("span",{staticClass:"line-number"},[e._v("29")]),n("br"),n("span",{staticClass:"line-number"},[e._v("30")]),n("br"),n("span",{staticClass:"line-number"},[e._v("31")]),n("br"),n("span",{staticClass:"line-number"},[e._v("32")]),n("br"),n("span",{staticClass:"line-number"},[e._v("33")]),n("br"),n("span",{staticClass:"line-number"},[e._v("34")]),n("br"),n("span",{staticClass:"line-number"},[e._v("35")]),n("br")])]),n("p",[e._v("看到Done，表示集群OK")]),e._v(" "),n("ol",{attrs:{start:"4"}},[n("li",[e._v("与集群交互\n「初始化执行命令结果」")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('thinker@Thinker .k8s % minikube kubectl -- get pods -A  \nNAMESPACE     NAME                               READY   STATUS    RESTARTS   AGE\nkube-system   coredns-65c54cc984-hcpd2           1/1     Running   0          5h12m\nkube-system   etcd-minikube                      1/1     Running   0          5h13m\nkube-system   kube-apiserver-minikube            1/1     Running   0          5h13m\nkube-system   kube-controller-manager-minikube   1/1     Running   0          5h13m\nkube-system   kube-proxy-2xrts                   1/1     Running   0          5h12m\nkube-system   kube-scheduler-minikube            1/1     Running   0          5h13m\nkube-system   storage-provisioner                1/1     Running   0          5h13m\n\nkubectl get po -A \n\nNAMESPACE              NAME                                         READY   STATUS             RESTARTS      AGE\ndefault                      hello-minikube-fdf664d87-5rx5m         0/1     ImagePullBackOff   0             37h\nkube-system            coredns-65c54cc984-sxjb7                  1/1     Running            2 (14m ago)   38h\nkube-system            etcd-minikube                                      1/1     Running            2 (14m ago)   38h\nkube-system            kube-apiserver-minikube                      1/1     Running            2 (14m ago)   38h\nkube-system            kube-controller-manager-minikube       1/1     Running            2 (14m ago)   38h\nkube-system            kube-proxy-rvfbr                                  1/1     Running            2 (14m ago)   38h\nkube-system            kube-scheduler-minikube                      1/1     Running            2 (14m ago)   38h\nkube-system            storage-provisioner                              1/1     Running            2 (14m ago)   38h\nkubernetes-dashboard   dashboard-metrics-scraper-57d8d5b8b8-8d6mw   0/1     ImagePullBackOff   0             38h\nkubernetes-dashboard   kubernetes-dashboard-6f75b5c656-v7ssx        0/1     ImagePullBackOff   0             38h\n\nkubectl describe pod dashboard-metrics-scraper-57d8d5b8b8-8d6mw  查看详情，为啥ImagePullBackOff\n\nFailed to pull image "nginx:1.14.2": rpc error: code = Unknown desc = Error response from daemon: Get "https://registry-1.docker.io/v2/"\n\n使用minikube ssh命令连接到虚拟机环境。\nminikube ssh\n\n使用国内镜像源获取镜像文件\ndocker pull registry.cn-hangzhou.aliyuncs.com/google_containers/nginx:1.14.2\n\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br"),n("span",{staticClass:"line-number"},[e._v("20")]),n("br"),n("span",{staticClass:"line-number"},[e._v("21")]),n("br"),n("span",{staticClass:"line-number"},[e._v("22")]),n("br"),n("span",{staticClass:"line-number"},[e._v("23")]),n("br"),n("span",{staticClass:"line-number"},[e._v("24")]),n("br"),n("span",{staticClass:"line-number"},[e._v("25")]),n("br"),n("span",{staticClass:"line-number"},[e._v("26")]),n("br"),n("span",{staticClass:"line-number"},[e._v("27")]),n("br"),n("span",{staticClass:"line-number"},[e._v("28")]),n("br"),n("span",{staticClass:"line-number"},[e._v("29")]),n("br"),n("span",{staticClass:"line-number"},[e._v("30")]),n("br"),n("span",{staticClass:"line-number"},[e._v("31")]),n("br"),n("span",{staticClass:"line-number"},[e._v("32")]),n("br"),n("span",{staticClass:"line-number"},[e._v("33")]),n("br"),n("span",{staticClass:"line-number"},[e._v("34")]),n("br")])]),n("ol",{attrs:{start:"5"}},[n("li",[e._v("运行dashboard，可浏览器访问「」")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('minikube dashboard\nminikube dashboard --alsologtostderr -v=1 （可查看详细信息）\n\nkubectl get pods --all-namespaces 查看所有pod\nkubectl logs --namespace=kubernetes-dashboard kubernetes-dashboard-6f75b5c656-tvxzf\n\n$ minikube dashboard --url  （获取dashboard链接）\n🤔  Verifying dashboard health ...\n🚀  Launching proxy ...\n🤔  Verifying proxy health ...\nhttp://127.0.0.1:29325/api/v1/namespaces/kubernetes-dashboard/services/http:kubernetes-dashboard:/proxy/\n这个是容器内的地址，只能内网访问，需要kubectl代理出来\n查看云服务内网IP，新打开一个终端：\nkubectl proxy --port=10000 --address="10.0.12.15" --accept-hosts="^.*"\nStarting to serve on 10.0.12.15:10000\n然后外部即可访问\nhttp://175.178.125.91:10000/api/v1/namespaces/kubernetes-dashboard/services/http:kubernetes-dashboard:/proxy/#/workloads?namespace=default\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br")])]),n("p",[e._v("kubectl port-forward service/hello 9999:80")]),e._v(" "),n("p",[e._v("kubectl create deployment hello2 --image=kicbase/echo-server:1.0\nkubectl expose deployment hello2 --type=NodePort --port=10001\nkubectl port-forward service/hello2 10001:10001\nkubectl port-forward --address 0.0.0.0 -n default service/hello2  31107:31107\nkubectl get pods\nkubectl exec hello-b7b6dcbf7-lz6k7 -- curl -s 10.109.40.34")]),e._v(" "),n("ol",{attrs:{start:"6"}},[n("li",[e._v("部署应用")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("thinker@Thinker .k8s % kubectl create deployment hello-minikube --image=kicbase/echo-server:1.0\ndeployment.apps/hello-minikube created\n\nthinker@Thinker .k8s % kubectl expose deployment hello-minikube --type=NodePort --port=10000\nservice/hello-minikube exposed\n\nthinker@Thinker .k8s % kubectl get services hello-minikube\nNAME             TYPE       CLUSTER-IP       EXTERNAL-IP   PORT(S)           AGE\nhello-minikube   NodePort   10.110.155.103   <none>        10000:30910/TCP   24s\n\nthinker@Thinker .k8s % minikube service hello-minikube\n|-----------|----------------\t|-------------\t|---------------------------|\n| NAMESPACE\t|      NAME\t\t\t| TARGET PORT\t|            URL\t\t\t|\n|-----------|----------------\t|-------------\t|---------------------------|\n| default\t| hello-minikube\t|       10000\t| http://192.168.49.2:30910\t|\n|-----------|----------------\t|-------------\t|---------------------------|\n🏃  Starting tunnel for service hello-minikube.\n|-----------|----------------|-------------|------------------------|\n| NAMESPACE |      NAME      | TARGET PORT |          URL           |\n|-----------|----------------|-------------|------------------------|\n| default   | hello-minikube |             | http://127.0.0.1:57824 |\n|-----------|----------------|-------------|------------------------|\n🎉  Opening service default/hello-minikube in default browser...\n❗  Because you are using a Docker driver on darwin, the terminal needs to be open to run it.\n\n虽然部署显示运行10000端口， 但是现在访问 10000是不通的， 这个端口是运行在自身的容器里， 想要外部访问，需要在外部端口和容器的10000端口之间做一个映射\nkubectl port-forward service/hello-minikube 10000:10000\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br"),n("span",{staticClass:"line-number"},[e._v("20")]),n("br"),n("span",{staticClass:"line-number"},[e._v("21")]),n("br"),n("span",{staticClass:"line-number"},[e._v("22")]),n("br"),n("span",{staticClass:"line-number"},[e._v("23")]),n("br"),n("span",{staticClass:"line-number"},[e._v("24")]),n("br"),n("span",{staticClass:"line-number"},[e._v("25")]),n("br"),n("span",{staticClass:"line-number"},[e._v("26")]),n("br"),n("span",{staticClass:"line-number"},[e._v("27")]),n("br"),n("span",{staticClass:"line-number"},[e._v("28")]),n("br")])]),n("ol",{attrs:{start:"7"}},[n("li",[e._v("kubectl基本操作")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('列出kubernetes集群中的可用服务\nkubectl get svc --all-namespaces -o wide\n\n查看某服务的详细信息（hello-minikube 为name字段对应值）\nkubectl describe svc hello-minikube --namespace=default\n\n删除服务\nkubectl delete svc --namespace=default  hello-minikube\n\nk8s中正确删除一个pod\n1、先删除pod\n2、再删除对应的deployment\n删除pod\nthinker@Thinker .k8s % kubectl get pods  \nNAME                             READY   STATUS             RESTARTS   AGE\nbalanced-5f95856476-2w62s        0/1     ImagePullBackOff   0          37m\nhello-minikube-fdf664d87-5dszd   0/1     ImagePullBackOff   0          35m\nthinker@Thinker .k8s % kubectl delete pod hello-minikube-fdf664d87-5dszd\npod "hello-minikube-fdf664d87-5dszd" deleted\n删除deployment\nthinker@Thinker .k8s % kubectl get deployment\nNAME             READY   UP-TO-DATE   AVAILABLE   AGE\nbalanced         0/1     1            0           39m\nhello-minikube   0/1     1            0           38m\nthinker@Thinker .k8s % kubectl delete deployment hello-minikube\ndeployment.apps "hello-minikube" deleted\n')])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br"),n("span",{staticClass:"line-number"},[e._v("17")]),n("br"),n("span",{staticClass:"line-number"},[e._v("18")]),n("br"),n("span",{staticClass:"line-number"},[e._v("19")]),n("br"),n("span",{staticClass:"line-number"},[e._v("20")]),n("br"),n("span",{staticClass:"line-number"},[e._v("21")]),n("br"),n("span",{staticClass:"line-number"},[e._v("22")]),n("br"),n("span",{staticClass:"line-number"},[e._v("23")]),n("br"),n("span",{staticClass:"line-number"},[e._v("24")]),n("br"),n("span",{staticClass:"line-number"},[e._v("25")]),n("br"),n("span",{staticClass:"line-number"},[e._v("26")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("useradd -d /usr/docker -m docker\nusermod -a -G docker docker\ngroupadd docker\nuseradd -G docker ubuntu\nubuntu@VM-12-15-ubuntu:~$ sudo more /etc/sudoers\n\n解决\nsudo: /etc/sudoers is world writable\nsudo: no valid sudoers sources found, quitting\nsudo: unable to initialize policy plugin\n\nhttps://iqcode.com/code/other/polkit-agent-helper-1-error-response-to-policykit-daemon-gdbuserrororgfreedesktoppolicykit1errorfailed-no-session-for-cookie\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br")])]),n("ol",{attrs:{start:"3"}},[n("li",[e._v("mac操作docker")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("launchctl list | grep docker\nopen /Applications/Docker.app\n\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br")])]),n("ol",{attrs:{start:"4"}},[n("li",[e._v("参考：https://minikube.sigs.k8s.io/docs/start/")])]),e._v(" "),n("p",[e._v("启动 minikube\nminikube 是本地 Kubernetes，专注于让 Kubernetes 易于学习和开发。")]),e._v(" "),n("p",[e._v("您只需要 Docker（或类似的兼容）容器或虚拟机环境，而 Kubernetes 只需一个命令：minikube start")]),e._v(" "),n("p",[e._v("你需要什么\n2 个或更多 CPU\n2GB 可用内存\n20GB 可用磁盘空间\n网络连接\n容器或虚拟机管理器，例如：Docker、QEMU、Hyperkit、Hyper-V、KVM、Parallels、Podman、VirtualBox或VMware Fusion/Workstation\n1安装\n单击描述您的目标平台的按钮。对于其他架构，请参阅发布页面以获取 minikube 二进制文件的完整列表。")]),e._v(" "),n("p",[e._v("操作系统")]),e._v(" "),n("p",[e._v("建筑学")]),e._v(" "),n("p",[e._v("发布类型")]),e._v(" "),n("p",[e._v("安装程序类型")]),e._v(" "),n("p",[e._v("要使用二进制下载在x86-64 macOS上安装最新的 minikube稳定版本：")]),e._v(" "),n("p",[e._v("curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-darwin-amd64\nsudo install minikube-darwin-amd64 /usr/local/bin/minikube\n2启动集群\n从具有管理员访问权限的终端（但未以根用户身份登录）运行：")]),e._v(" "),n("p",[e._v("minikube start\n如果 minikube 无法启动，请参阅驱动程序页面以帮助设置兼容的容器或虚拟机管理器。")]),e._v(" "),n("p",[e._v("3与您的集群交互\n如果你已经安装了 kubectl，你现在可以使用它来访问你闪亮的新集群：")]),e._v(" "),n("p",[e._v("kubectl get po -A\n或者，minikube 可以下载合适版本的 kubectl，你应该可以像这样使用它：")]),e._v(" "),n("p",[e._v("minikube kubectl -- get po -A\n您还可以通过将以下内容添加到您的 shell 配置中来让您的生活更轻松：")]),e._v(" "),n("p",[e._v('alias kubectl="minikube kubectl --"\n最初，某些服务（例如存储供应商）可能尚未处于运行状态。这是集群启动期间的正常情况，会立即自行解决。为了进一步了解您的集群状态，minikube 捆绑了 Kubernetes 仪表板，让您轻松适应新环境：')]),e._v(" "),n("p",[e._v("minikube dashboard\n4部署应用\n服务\n负载均衡器\n入口\n创建示例部署并将其公开在端口 8080 上：")]),e._v(" "),n("p",[e._v("kubectl create deployment hello-minikube --image=kicbase/echo-server:1.0\nkubectl expose deployment hello-minikube --type=NodePort --port=8080\n这可能需要一点时间，但您的部署将在您运行时很快显示出来：")]),e._v(" "),n("p",[e._v("kubectl get services hello-minikube\n访问此服务的最简单方法是让 minikube 为您启动一个网络浏览器：")]),e._v(" "),n("p",[e._v("minikube service hello-minikube\n或者，使用 kubectl 转发端口：")]),e._v(" "),n("p",[e._v("kubectl port-forward service/hello-minikube 7080:8080\n多田！您的应用程序现在可以在http://localhost:7080/获得。")]),e._v(" "),n("p",[e._v("您应该能够在应用程序输出中看到请求元数据。尝试更改请求的路径并观察更改。同样，您可以执行 POST 请求并观察输出中显示的正文。")]),e._v(" "),n("p",[e._v("5管理您的集群\n在不影响部署的应用程序的情况下暂停 Kubernetes：")]),e._v(" "),n("p",[e._v("minikube pause\n取消暂停暂停的实例：")]),e._v(" "),n("p",[e._v("minikube unpause\n停止集群：")]),e._v(" "),n("p",[e._v("minikube stop\n更改默认内存限制（需要重新启动）：")]),e._v(" "),n("p",[e._v("minikube config set memory 9001\n浏览易于安装的 Kubernetes 服务的目录：")]),e._v(" "),n("p",[e._v("minikube addons list\n创建第二个运行较旧 Kubernetes 版本的集群：")]),e._v(" "),n("p",[e._v("minikube start -p aged --kubernetes-version=v1.16.1\n删除所有 minikube 集群：")]),e._v(" "),n("p",[e._v("minikube delete --all")]),e._v(" "),n("p",[e._v("##############################################\nhostnamectl set-hostname  k8s-master-91\nhostnamectl set-hostname k8s-node-93")]),e._v(" "),n("p",[e._v("cat >> /etc/hosts<<EOF\n175.178.125.91 k8s-master-91\n39.98.45.93 k8s-node-93\nEOF")]),e._v(" "),n("p",[e._v("ssh-copy-id -i ~/.ssh/id_rsa.pub root@k8s-master-91\nssh-copy-id -i ~/.ssh/id_rsa.pub root@k8s-node-93")])])}),[],!1,null,null,null);s.default=t.exports}}]);