(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{640:function(s,t,a){"use strict";a.r(t);var e=a(35),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#运行参数"}},[s._v("运行参数")]),a("ul",[a("li",[a("a",{attrs:{href:"#命令行方式"}},[s._v("命令行方式")])]),a("li",[a("a",{attrs:{href:"#main-运行"}},[s._v("main()运行")])]),a("li",[a("a",{attrs:{href:"#pytest参数"}},[s._v("pytest参数")])])])]),a("li",[a("a",{attrs:{href:"#运行指定用例"}},[s._v("运行指定用例")])]),a("li",[a("a",{attrs:{href:"#忽略用例"}},[s._v("忽略用例")])]),a("li",[a("a",{attrs:{href:"#setup-和-teardown"}},[s._v("setUp 和 tearDown")])]),a("li",[a("a",{attrs:{href:"#pytest-ini"}},[s._v("pytest.ini")])]),a("li",[a("a",{attrs:{href:"#多线程、多进程执行用例"}},[s._v("多线程、多进程执行用例")])]),a("li",[a("a",{attrs:{href:"#失败重跑"}},[s._v("失败重跑")])]),a("li",[a("a",{attrs:{href:"#报告"}},[s._v("报告")]),a("ul",[a("li",[a("a",{attrs:{href:"#pytest-html"}},[s._v("pytest-html")])]),a("li",[a("a",{attrs:{href:"#allure"}},[s._v("allure")])]),a("li",[a("a",{attrs:{href:"#pywebreport"}},[s._v("pywebreport")])])])])])]),a("p"),s._v(" "),a("h2",{attrs:{id:"运行参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行参数"}},[s._v("#")]),s._v(" 运行参数")]),s._v(" "),a("h3",{attrs:{id:"命令行方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令行方式"}},[s._v("#")]),s._v(" 命令行方式")]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("python -m pytest "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"main-运行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#main-运行"}},[s._v("#")]),s._v(" main()运行")]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("pytest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("pytest 的参数必须放在一个list或者tuple里")]),s._v(" "),a("h3",{attrs:{id:"pytest参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pytest参数"}},[s._v("#")]),s._v(" pytest参数")]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("pytest --help\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v(":::")]),s._v(" "),a("ol",[a("li",[s._v("-m：标记\n"),a("ul",[a("li",[s._v("pytest提供装饰器@pytest.mark.xxx，xxx表示分组名，类和方法都可以加")]),s._v(" "),a("li",[s._v("运行时，分组可以使用and、or分割")]),s._v(" "),a("li",[s._v('pytest -m "m1 and m2"，选中带有m1和m2标记的用例')]),s._v(" "),a("li",[s._v('pytest -m "m1 or m2"，选中带有m1或者m2标记的用例')]),s._v(" "),a("li",[s._v('pytest -m "m1 and not m2"，选中带有m1标记的用例，不运行m2标记的用例')])])]),s._v(" "),a("li",[s._v("-v：运行时输出详细信息\n"),a("ul",[a("li",[s._v("不使用-v参数，运行时不会显示运行的具体测试用例名称；使用-v参数，会在console里打印出具体哪条测试用例被运行。")])])]),s._v(" "),a("li",[s._v("-q：简化输出信息")]),s._v(" "),a("li",[s._v("-k：指定运行用例，按照文件名、类名、方法名来模糊匹配\n"),a("ul",[a("li",[s._v("模糊匹配，可用and，or区分，匹配范围有文件、类、函数")])])]),s._v(" "),a("li",[s._v("-x：出现一条case失败，就退出运行\n:::")])]),s._v(" "),a("h2",{attrs:{id:"运行指定用例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行指定用例"}},[s._v("#")]),s._v(" 运行指定用例")]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("pytest "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" 执行所有当前文件夹及子文件夹的所有用例\npytest "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/tests 执行与当前目录同级的tests目录及子目录的所有用例\npytest test_xx.py 执行test_xx.py文件下的所有用例\npytest test_xx.py::TestXxx 执行test_xx.py文件下TestXxx类的所有用例\npytest test_xx.py::TestXxx::test_xxx 执行test_xx.py文件下TestXxx类下test_xxx用例\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("程序中运行写法：pytest.main([模块.py::类::方法])")]),s._v(" "),a("h2",{attrs:{id:"忽略用例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#忽略用例"}},[s._v("#")]),s._v(" 忽略用例")]),s._v(" "),a("ol",[a("li",[s._v("@pytest.mark.skip(reason='暂不执行')，运行时会直接忽略此条用例")]),s._v(" "),a("li",[s._v('@pytest.mark.skipif(flag==1,reason="按条件忽略")，当文件中flag!=1时，才会执行该用例')])]),s._v(" "),a("h2",{attrs:{id:"setup-和-teardown"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setup-和-teardown"}},[s._v("#")]),s._v(" setUp 和 tearDown")]),s._v(" "),a("ol",[a("li",[s._v("module级别")]),s._v(" "),a("li",[s._v("class级别")]),s._v(" "),a("li",[s._v("method级别")])]),s._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v('"""\nAuthor:liulinyuan\nfile:setup_teardown.py\ndatetime:2022/9/9 21:44\n"""')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[s._v('"""\nsetup_module(module) 和 teardown_module(module) 的写法最好不要改动\n当setup_module出错，teardown_module不会被执行\n================================================================================\nsetup_class(cls) 和 teardown_class(cls) 的写法最好不要改动。\nsetup_class(cls) 和 teardown_class(cls) 必须以 @classmethod 装饰。\nsetup_class(cls) 出错，teardown_class(cls) 不会被执行。\n================================================================================\nsetup_method(self, method) 和 teardown_method(self, method) 的写法最好不要改动。\nsetup_method(self, method)用例执行失败时，teardown_method(self, method) 不会被执行。\n"""')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setup_module")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'setup_module'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("teardown_module")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("module"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'teardown_module'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("TestXxx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@classmethod")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setup_class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cls"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'setup_class'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setup_method")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'setup_method'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("test_something")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test_something'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("teardown_method")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("self"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'teardown_method'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[s._v("@classmethod")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("def")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("teardown_class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("cls"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'teardown_class'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br")])]),a("h2",{attrs:{id:"pytest-ini"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pytest-ini"}},[s._v("#")]),s._v(" pytest.ini")]),s._v(" "),a("p",[s._v("pytest的主配置文件，可破除默认pattern，灵活命名测试文件，位于项目根目录")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("TIP")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[pytest]\npython_classes = *\npython_files= *\npython_functions = test*\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("ul",[a("li",[s._v("*表示匹配所有")]),s._v(" "),a("li",[s._v("python_files，表示要匹配的测试文件")]),s._v(" "),a("li",[s._v("python_classes，表示要匹配的测试类")]),s._v(" "),a("li",[s._v("python_functions，表示要匹配的测试方法")]),s._v(" "),a("li",[s._v("pytest底层是使用的时glob库，可以参考"),a("a",{attrs:{href:"https://docs.python.org/zh-cn/3/library/glob.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("这里"),a("OutboundLink")],1)])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[pytest]\nmarkers = \n    smoke: run smoke test\n    sanity: run sanity test\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("ul",[a("li",[s._v("pytest.ini里注册标签，统一管理")]),s._v(" "),a("li",[s._v("用例里面仍需要打标签")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[pytest]\ntestpaths=tests\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ul",[a("li",[s._v("执行pytest时，会自动查询testpaths文件夹，如果没有设置testpaths，则会自动从当前文件夹找起")]),s._v(" "),a("li",[s._v("pytest.ini还有更改默认命令行参数、指定pytest最低版本、指定忽略某目录、禁用XPASS等功能，backlog！！！")])])]),s._v(" "),a("h2",{attrs:{id:"多线程、多进程执行用例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多线程、多进程执行用例"}},[s._v("#")]),s._v(" 多线程、多进程执行用例")]),s._v(" "),a("p",[s._v("pytest框架中提供可用于分布式执行测试用例的插件：pytest-parallel、pytest-xdist")]),s._v(" "),a("ol",[a("li",[s._v("pytest-parallel"),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("pip "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" pytest-parallel\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),s._v("注意，虽然最新的版本为 0.1.1，但在windows系统中需要指定安装 0.0.10 版本，否则使用 pytest-parallel 参数执行用例时会报如下错误。\n:::\nAttributeError: Can't pickle local object 'pytest_addoption."),a("locals",[s._v(".label_type."),a("locals",[s._v(".a_label_type'\n:::"),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("pytest --workers "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\npytest --workers "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" --test-per-worker "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ul",[a("li",[s._v("说明\n"),a("ul",[a("li",[s._v("pytest-parallel 同时支持多线程、多进程两种方式执行测试用例")]),s._v(" "),a("li",[s._v("--workers n 指定运行的进程数为n，默认为1，windows系统中只能为1")]),s._v(" "),a("li",[s._v("--tests-per-worker m 指定运行的线程数为m")]),s._v(" "),a("li",[s._v("若两个参数都指定，则表示启动n个进程，每个进程最多启动m线程执行，总线程数=进程数*线程数")]),s._v(" "),a("li",[s._v("windows系统中不支持 --workers 取其他值，即只能为1，mac或linux系统中可取其他值")]),s._v(" "),a("li",[s._v("仅仅支持python3.6版本及以上")])])])])])],1)],1),s._v(" "),a("li",[s._v("pytest-xdist"),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("pip "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" pytest-xdist\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("pytest -n "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("\npytest -n auto\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ul",[a("li",[s._v("说明：\n"),a("ul",[a("li",[s._v("pytest-xdist只支持多进程执行测试用例，不支持多线程执行")]),s._v(" "),a("li",[s._v("-n num，如-n 4 表示开启4个cpu进行执行测试用例")]),s._v(" "),a("li",[s._v("-n auto，表示使用与CPU内核一样多的进程来并发")]),s._v(" "),a("li",[s._v("pytest-xdist支持windows系统使用，同样也支持mac、linux")])])])])]),s._v(" "),a("li",[s._v("总结\n"),a("ul",[a("li",[s._v("pytest-parallel 支持多线程执行用例，但在windows系统中只支持单个进程执行，即windows中只能--workers=1。")]),s._v(" "),a("li",[s._v("pytest-xdist 只支持多进程执行用例，但可以在windows系统中进行参数设置。")]),s._v(" "),a("li",[s._v("推荐使用 pytest-parallel，因为支持多线程执行，且自动化测试项目一般会搭建在mac或linux系统中运行，--workers 可以取别的值。")])])])]),s._v(" "),a("h2",{attrs:{id:"失败重跑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#失败重跑"}},[s._v("#")]),s._v(" 失败重跑")]),s._v(" "),a("ol",[a("li",[s._v("安装模块"),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("pip "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -U pytest-rerunfailures\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[s._v("用法"),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("pytest test_xxx.py --reruns "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])]),s._v(" "),a("h2",{attrs:{id:"报告"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#报告"}},[s._v("#")]),s._v(" 报告")]),s._v(" "),a("h3",{attrs:{id:"pytest-html"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pytest-html"}},[s._v("#")]),s._v(" pytest-html")]),s._v(" "),a("h3",{attrs:{id:"allure"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#allure"}},[s._v("#")]),s._v(" allure")]),s._v(" "),a("ol",[a("li",[s._v("安装")])]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" apt-add-repository ppa:qameta/allure\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" allure\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("查看版本")])]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("allure --version\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("指定路径")])]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("pytest --alluredir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("./allure_reports\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[s._v("pytest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("main"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-m"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"smoke"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--alluredir=./allure_reports"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("生成报告")])]),s._v(" "),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("allure serve allure_reports\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"pywebreport"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pywebreport"}},[s._v("#")]),s._v(" pywebreport")]),s._v(" "),a("ol",[a("li",[s._v("安装"),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("pip "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" pywebreport\n备注：python版本"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.7")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[s._v("用法"),a("div",{staticClass:"language-shell script line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("pytest -q --report report.html\n可能会ImportError: cannot "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" name "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'soft_unicode'")]),s._v(" from "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'markupsafe'")]),s._v("\npip uninstall markupsafe\npython37 -m pip "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("markupsafe")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2.0")]),s._v(".1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("li",[s._v("参考官网："),a("a",{attrs:{href:"https://github.com/yongchin0821/pywebreport",target:"_blank",rel:"noopener noreferrer"}},[s._v("这里"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=n.exports}}]);