<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>杏壳儿</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.5675a7d7.css" as="style"><link rel="preload" href="/assets/js/app.dd60fddf.js" as="script"><link rel="preload" href="/assets/js/2.1d799614.js" as="script"><link rel="preload" href="/assets/js/27.357c2f0c.js" as="script"><link rel="prefetch" href="/assets/js/10.f42a5970.js"><link rel="prefetch" href="/assets/js/100.fd420176.js"><link rel="prefetch" href="/assets/js/101.fd3f9957.js"><link rel="prefetch" href="/assets/js/102.d3c4087c.js"><link rel="prefetch" href="/assets/js/103.5bf5f364.js"><link rel="prefetch" href="/assets/js/104.c19dc6fc.js"><link rel="prefetch" href="/assets/js/105.3644a723.js"><link rel="prefetch" href="/assets/js/106.c99225f8.js"><link rel="prefetch" href="/assets/js/107.97852924.js"><link rel="prefetch" href="/assets/js/108.212c27f0.js"><link rel="prefetch" href="/assets/js/109.d6e4c811.js"><link rel="prefetch" href="/assets/js/11.91f395ed.js"><link rel="prefetch" href="/assets/js/110.96b9b201.js"><link rel="prefetch" href="/assets/js/111.78b25fde.js"><link rel="prefetch" href="/assets/js/112.8c82f9a4.js"><link rel="prefetch" href="/assets/js/113.aae564aa.js"><link rel="prefetch" href="/assets/js/114.313f0d5b.js"><link rel="prefetch" href="/assets/js/115.844f47cf.js"><link rel="prefetch" href="/assets/js/116.4d2691a0.js"><link rel="prefetch" href="/assets/js/117.bd36d4a2.js"><link rel="prefetch" href="/assets/js/118.d205f7e7.js"><link rel="prefetch" href="/assets/js/119.ee336fe8.js"><link rel="prefetch" href="/assets/js/12.5e7abec9.js"><link rel="prefetch" href="/assets/js/120.f5ba9dbe.js"><link rel="prefetch" href="/assets/js/121.05e1c205.js"><link rel="prefetch" href="/assets/js/122.779c5f8c.js"><link rel="prefetch" href="/assets/js/123.64ad1fde.js"><link rel="prefetch" href="/assets/js/124.72120675.js"><link rel="prefetch" href="/assets/js/125.7f1e0958.js"><link rel="prefetch" href="/assets/js/126.dcd28d9f.js"><link rel="prefetch" href="/assets/js/127.428f223e.js"><link rel="prefetch" href="/assets/js/128.0ebf700a.js"><link rel="prefetch" href="/assets/js/129.3d7442ee.js"><link rel="prefetch" href="/assets/js/13.ec7d048b.js"><link rel="prefetch" href="/assets/js/130.b946546b.js"><link rel="prefetch" href="/assets/js/131.0ea40481.js"><link rel="prefetch" href="/assets/js/132.4a4437c1.js"><link rel="prefetch" href="/assets/js/133.7e17bb00.js"><link rel="prefetch" href="/assets/js/134.95928b65.js"><link rel="prefetch" href="/assets/js/135.fb730cc9.js"><link rel="prefetch" href="/assets/js/136.ce2e6b16.js"><link rel="prefetch" href="/assets/js/137.30dda982.js"><link rel="prefetch" href="/assets/js/138.9d9bd5df.js"><link rel="prefetch" href="/assets/js/139.19e62986.js"><link rel="prefetch" href="/assets/js/14.27407a31.js"><link rel="prefetch" href="/assets/js/140.425bbd4e.js"><link rel="prefetch" href="/assets/js/141.13f9ac88.js"><link rel="prefetch" href="/assets/js/142.b12b14dc.js"><link rel="prefetch" href="/assets/js/15.3653047a.js"><link rel="prefetch" href="/assets/js/16.7baae9f5.js"><link rel="prefetch" href="/assets/js/17.dcad52cb.js"><link rel="prefetch" href="/assets/js/18.bb46f976.js"><link rel="prefetch" href="/assets/js/19.0925b886.js"><link rel="prefetch" href="/assets/js/20.e2181917.js"><link rel="prefetch" href="/assets/js/21.2e00fc64.js"><link rel="prefetch" href="/assets/js/22.60af365a.js"><link rel="prefetch" href="/assets/js/23.9a6247e9.js"><link rel="prefetch" href="/assets/js/24.533a55d3.js"><link rel="prefetch" href="/assets/js/25.0d54429f.js"><link rel="prefetch" href="/assets/js/26.f70e7a58.js"><link rel="prefetch" href="/assets/js/28.05884156.js"><link rel="prefetch" href="/assets/js/29.b63f5d12.js"><link rel="prefetch" href="/assets/js/3.b3c0c8cc.js"><link rel="prefetch" href="/assets/js/30.c37379b8.js"><link rel="prefetch" href="/assets/js/31.e5583500.js"><link rel="prefetch" href="/assets/js/32.2f8a89ce.js"><link rel="prefetch" href="/assets/js/33.8526b5cc.js"><link rel="prefetch" href="/assets/js/34.8c476ba1.js"><link rel="prefetch" href="/assets/js/35.28a9e848.js"><link rel="prefetch" href="/assets/js/36.22caee50.js"><link rel="prefetch" href="/assets/js/37.f564431c.js"><link rel="prefetch" href="/assets/js/38.60510a45.js"><link rel="prefetch" href="/assets/js/39.b57d73b7.js"><link rel="prefetch" href="/assets/js/4.6dd544f6.js"><link rel="prefetch" href="/assets/js/40.a0f12257.js"><link rel="prefetch" href="/assets/js/41.ae21b83f.js"><link rel="prefetch" href="/assets/js/42.4a8b0eed.js"><link rel="prefetch" href="/assets/js/43.a4b1dbe5.js"><link rel="prefetch" href="/assets/js/44.7957e7b8.js"><link rel="prefetch" href="/assets/js/45.22f92df5.js"><link rel="prefetch" href="/assets/js/46.a7bd57b2.js"><link rel="prefetch" href="/assets/js/47.1076bbe9.js"><link rel="prefetch" href="/assets/js/48.10c8f82d.js"><link rel="prefetch" href="/assets/js/49.aea6f4f0.js"><link rel="prefetch" href="/assets/js/5.7fae9900.js"><link rel="prefetch" href="/assets/js/50.97341023.js"><link rel="prefetch" href="/assets/js/51.2213cc76.js"><link rel="prefetch" href="/assets/js/52.4b1c29e4.js"><link rel="prefetch" href="/assets/js/53.a6434736.js"><link rel="prefetch" href="/assets/js/54.59470ace.js"><link rel="prefetch" href="/assets/js/55.49cec6b6.js"><link rel="prefetch" href="/assets/js/56.06f2e67d.js"><link rel="prefetch" href="/assets/js/57.2e812620.js"><link rel="prefetch" href="/assets/js/58.e6ce6313.js"><link rel="prefetch" href="/assets/js/59.35026211.js"><link rel="prefetch" href="/assets/js/6.8c7a6ec4.js"><link rel="prefetch" href="/assets/js/60.cc2c97a8.js"><link rel="prefetch" href="/assets/js/61.8d91a90f.js"><link rel="prefetch" href="/assets/js/62.991f9147.js"><link rel="prefetch" href="/assets/js/63.85532e4f.js"><link rel="prefetch" href="/assets/js/64.90068745.js"><link rel="prefetch" href="/assets/js/65.ff870427.js"><link rel="prefetch" href="/assets/js/66.ba94b154.js"><link rel="prefetch" href="/assets/js/67.5158a096.js"><link rel="prefetch" href="/assets/js/68.54fe2ba5.js"><link rel="prefetch" href="/assets/js/69.bcb4c73f.js"><link rel="prefetch" href="/assets/js/7.3c7e6d86.js"><link rel="prefetch" href="/assets/js/70.00d41657.js"><link rel="prefetch" href="/assets/js/71.892ff6f5.js"><link rel="prefetch" href="/assets/js/72.2302172b.js"><link rel="prefetch" href="/assets/js/73.02125fde.js"><link rel="prefetch" href="/assets/js/74.23ba9330.js"><link rel="prefetch" href="/assets/js/75.c6915e81.js"><link rel="prefetch" href="/assets/js/76.f26b5808.js"><link rel="prefetch" href="/assets/js/77.e9b2145e.js"><link rel="prefetch" href="/assets/js/78.41764819.js"><link rel="prefetch" href="/assets/js/79.194bc603.js"><link rel="prefetch" href="/assets/js/8.1788d36a.js"><link rel="prefetch" href="/assets/js/80.4b57cedb.js"><link rel="prefetch" href="/assets/js/81.f9556a24.js"><link rel="prefetch" href="/assets/js/82.f18755ed.js"><link rel="prefetch" href="/assets/js/83.5c9f9489.js"><link rel="prefetch" href="/assets/js/84.5c47e245.js"><link rel="prefetch" href="/assets/js/85.1b40b497.js"><link rel="prefetch" href="/assets/js/86.774be43b.js"><link rel="prefetch" href="/assets/js/87.f2848ddb.js"><link rel="prefetch" href="/assets/js/88.0f0b4fab.js"><link rel="prefetch" href="/assets/js/89.2ae8eea2.js"><link rel="prefetch" href="/assets/js/9.c52fca3a.js"><link rel="prefetch" href="/assets/js/90.3e798661.js"><link rel="prefetch" href="/assets/js/91.329942cb.js"><link rel="prefetch" href="/assets/js/92.f6b412ea.js"><link rel="prefetch" href="/assets/js/93.1bad8fe5.js"><link rel="prefetch" href="/assets/js/94.8ab22d8b.js"><link rel="prefetch" href="/assets/js/95.af7ae9bb.js"><link rel="prefetch" href="/assets/js/96.b84c5880.js"><link rel="prefetch" href="/assets/js/97.8584121b.js"><link rel="prefetch" href="/assets/js/98.3d7a6b2a.js"><link rel="prefetch" href="/assets/js/99.da28339e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5675a7d7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/开心果.png" alt="杏壳儿" class="logo"> <span class="site-name can-hide">杏壳儿</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="软件测试体系" class="dropdown-title"><span class="title">软件测试体系</span> <span class="arrow down"></span></button> <button type="button" aria-label="软件测试体系" class="mobile-dropdown-title"><span class="title">软件测试体系</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/qa/basics/" class="nav-link">
  测试基础
</a></li><li class="dropdown-item"><!----> <a href="/qa/automatic/" class="nav-link">
  自动测试
</a></li><li class="dropdown-item"><!----> <a href="/qa/performance/" class="nav-link">
  性能测试
</a></li><li class="dropdown-item"><!----> <a href="/qa/special/" class="nav-link">
  专项测试
</a></li><li class="dropdown-item"><!----> <a href="/qa/security/" class="nav-link">
  安全测试
</a></li><li class="dropdown-item"><!----> <a href="/qa/tool/" class="nav-link">
  测试工具
</a></li><li class="dropdown-item"><!----> <a href="/qa/framework/" class="nav-link">
  测试框架
</a></li><li class="dropdown-item"><!----> <a href="/qa/view/" class="nav-link">
  测试思考
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/basic/network/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/basic/os/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/basic/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/basic/algorithms/" class="nav-link">
  数据结构与算法
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">前端游乐场</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">前端游乐场</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/vue/" class="nav-link">
  VUE
</a></li><li class="dropdown-item"><!----> <a href="/frontend/css/" class="nav-link">
  CSS
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端训练场" class="dropdown-title"><span class="title">后端训练场</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端训练场" class="mobile-dropdown-title"><span class="title">后端训练场</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          编程语言
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/python/" class="nav-link">
  Python
</a></li><li class="dropdown-subitem"><a href="/backend/java/" class="nav-link">
  Java
</a></li></ul></li><li class="dropdown-item"><h4>
          WEB框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/django/" class="nav-link">
  Django
</a></li><li class="dropdown-subitem"><a href="/backend/drf/" class="nav-link">
  Django REST Framework
</a></li></ul></li><li class="dropdown-item"><h4>
          中间件
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/celery/" class="nav-link">
  Celery
</a></li></ul></li><li class="dropdown-item"><h4>
          数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/mysql/" class="nav-link">
  Mysql
</a></li><li class="dropdown-subitem"><a href="/backend/redis/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Redis
</a></li><li class="dropdown-subitem"><a href="/backend/mongodb/" class="nav-link">
  Mongodb
</a></li><li class="dropdown-subitem"><a href="/backend/elasticsearch/" class="nav-link">
  Elasticsearch
</a></li></ul></li><li class="dropdown-item"><h4>
          部署
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/uwsgi/" class="nav-link">
  Uwsgi
</a></li><li class="dropdown-subitem"><a href="/backend/gunicorn/" class="nav-link">
  Gunicorn
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DevOps" class="dropdown-title"><span class="title">DevOps</span> <span class="arrow down"></span></button> <button type="button" aria-label="DevOps" class="mobile-dropdown-title"><span class="title">DevOps</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/devops/docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/devops/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/devops/notes/" class="nav-link">
  DevOps笔记
</a></li><li class="dropdown-item"><!----> <a href="/devops/efficiency/" class="nav-link">
  研发效能
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="软能力" class="dropdown-title"><span class="title">软能力</span> <span class="arrow down"></span></button> <button type="button" aria-label="软能力" class="mobile-dropdown-title"><span class="title">软能力</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/softskills/mind/" class="nav-link">
  思考模型
</a></li><li class="dropdown-item"><!----> <a href="/softskills/communication/" class="nav-link">
  沟通能力
</a></li></ul></div></div><div class="nav-item"><a href="/opensource/" class="nav-link">
  开源前哨
</a></div><div class="nav-item"><a href="/memo/" class="nav-link">
  备忘录
</a></div><div class="nav-item"><a href="/interview/" class="nav-link">
  面试指南
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="软件测试体系" class="dropdown-title"><span class="title">软件测试体系</span> <span class="arrow down"></span></button> <button type="button" aria-label="软件测试体系" class="mobile-dropdown-title"><span class="title">软件测试体系</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/qa/basics/" class="nav-link">
  测试基础
</a></li><li class="dropdown-item"><!----> <a href="/qa/automatic/" class="nav-link">
  自动测试
</a></li><li class="dropdown-item"><!----> <a href="/qa/performance/" class="nav-link">
  性能测试
</a></li><li class="dropdown-item"><!----> <a href="/qa/special/" class="nav-link">
  专项测试
</a></li><li class="dropdown-item"><!----> <a href="/qa/security/" class="nav-link">
  安全测试
</a></li><li class="dropdown-item"><!----> <a href="/qa/tool/" class="nav-link">
  测试工具
</a></li><li class="dropdown-item"><!----> <a href="/qa/framework/" class="nav-link">
  测试框架
</a></li><li class="dropdown-item"><!----> <a href="/qa/view/" class="nav-link">
  测试思考
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/basic/network/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/basic/os/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/basic/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/basic/algorithms/" class="nav-link">
  数据结构与算法
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">前端游乐场</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">前端游乐场</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/vue/" class="nav-link">
  VUE
</a></li><li class="dropdown-item"><!----> <a href="/frontend/css/" class="nav-link">
  CSS
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端训练场" class="dropdown-title"><span class="title">后端训练场</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端训练场" class="mobile-dropdown-title"><span class="title">后端训练场</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          编程语言
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/python/" class="nav-link">
  Python
</a></li><li class="dropdown-subitem"><a href="/backend/java/" class="nav-link">
  Java
</a></li></ul></li><li class="dropdown-item"><h4>
          WEB框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/django/" class="nav-link">
  Django
</a></li><li class="dropdown-subitem"><a href="/backend/drf/" class="nav-link">
  Django REST Framework
</a></li></ul></li><li class="dropdown-item"><h4>
          中间件
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/celery/" class="nav-link">
  Celery
</a></li></ul></li><li class="dropdown-item"><h4>
          数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/mysql/" class="nav-link">
  Mysql
</a></li><li class="dropdown-subitem"><a href="/backend/redis/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Redis
</a></li><li class="dropdown-subitem"><a href="/backend/mongodb/" class="nav-link">
  Mongodb
</a></li><li class="dropdown-subitem"><a href="/backend/elasticsearch/" class="nav-link">
  Elasticsearch
</a></li></ul></li><li class="dropdown-item"><h4>
          部署
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/uwsgi/" class="nav-link">
  Uwsgi
</a></li><li class="dropdown-subitem"><a href="/backend/gunicorn/" class="nav-link">
  Gunicorn
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DevOps" class="dropdown-title"><span class="title">DevOps</span> <span class="arrow down"></span></button> <button type="button" aria-label="DevOps" class="mobile-dropdown-title"><span class="title">DevOps</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/devops/docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/devops/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/devops/notes/" class="nav-link">
  DevOps笔记
</a></li><li class="dropdown-item"><!----> <a href="/devops/efficiency/" class="nav-link">
  研发效能
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="软能力" class="dropdown-title"><span class="title">软能力</span> <span class="arrow down"></span></button> <button type="button" aria-label="软能力" class="mobile-dropdown-title"><span class="title">软能力</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/softskills/mind/" class="nav-link">
  思考模型
</a></li><li class="dropdown-item"><!----> <a href="/softskills/communication/" class="nav-link">
  沟通能力
</a></li></ul></div></div><div class="nav-item"><a href="/opensource/" class="nav-link">
  开源前哨
</a></div><div class="nav-item"><a href="/memo/" class="nav-link">
  备忘录
</a></div><div class="nav-item"><a href="/interview/" class="nav-link">
  面试指南
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>目录</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/backend/redis/" aria-current="page" class="active sidebar-link">Redis基础知识</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/backend/redis/#引言" class="sidebar-link">引言</a></li><li class="sidebar-sub-header"><a href="/backend/redis/#redis介绍" class="sidebar-link">redis介绍</a></li><li class="sidebar-sub-header"><a href="/backend/redis/#redis环境安装" class="sidebar-link">redis环境安装</a></li><li class="sidebar-sub-header"><a href="/backend/redis/#redis数据类型" class="sidebar-link">redis数据类型</a></li><li class="sidebar-sub-header"><a href="/backend/redis/#python操作redis" class="sidebar-link">Python操作redis</a></li><li class="sidebar-sub-header"><a href="/backend/redis/#redis测试场景" class="sidebar-link">Redis测试场景</a></li></ul></li><li><a href="/backend/redis/Redis架构演化之路.html" class="sidebar-link">Redis架构演化之路</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p></p><div class="table-of-contents"><ul><li><a href="#引言">引言</a><ul><li><a href="#背景">背景</a></li><li><a href="#关系型数据库-rmdbs-与非关系型数据库-nosql-的对比">关系型数据库（RMDBS）与非关系型数据库（NoSQL）的对比</a></li></ul></li><li><a href="#redis介绍">redis介绍</a><ul><li><a href="#定义">定义</a></li><li><a href="#redis特性">redis特性</a></li><li><a href="#redis解决什么问题-与传统数据库相比">Redis解决什么问题（与传统数据库相比）</a></li><li><a href="#redis的应用场景">Redis的应用场景</a></li><li><a href="#redis的数据类型及主要特性">Redis的数据类型及主要特性</a></li></ul></li><li><a href="#redis环境安装">redis环境安装</a><ul><li><a href="#下载和安装">下载和安装</a></li><li><a href="#redis的配置">redis的配置</a></li><li><a href="#redis的使用">Redis的使用</a></li></ul></li><li><a href="#redis数据类型">redis数据类型</a><ul><li><a href="#string类型">string类型:</a></li><li><a href="#hash类型">hash类型</a></li><li><a href="#list类型">list类型</a></li><li><a href="#set类型">set类型</a></li><li><a href="#zset类型-sortedset">zset类型(sortedSet)</a></li><li><a href="#使用场景">使用场景</a></li><li><a href="#任何数据类型都通用的命令">任何数据类型都通用的命令</a></li></ul></li><li><a href="#python操作redis">Python操作redis</a><ul><li><a href="#python对redis基本操作">python对redis基本操作</a></li><li><a href="#redis案例">redis案例</a></li></ul></li><li><a href="#redis测试场景">Redis测试场景</a><ul><li><a href="#参考">参考</a></li></ul></li></ul></div><p></p> <h2 id="引言"><a href="#引言" class="header-anchor">#</a> 引言</h2> <h3 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h3> <ul><li>在Web应用发展的初期，那时关系型数据库受到了较为广泛的关注和应用，原因是因为那时候Web站点基本上访问和并发不高、交互也较少。而在后来，随着访问量的提升，使用关系型数据库的Web站点多多少少都开始在性能上出现了一些瓶颈，而瓶颈的源头一般是在磁盘的I/O上。而随着互联网技术的进一步发展，各种类型的应用层出不穷，这导致在当今云计算、大数据盛行的时代，对性能有了更多的需求，主要体现在以下四个方面：
<ul><li>低延迟的读写速度：应用快速地反应能极大地提升用户的满意度</li> <li>支撑海量的数据和流量：对于搜索这样大型应用而言，需要利用PB级别的数据和能应对百万级的流量</li> <li>大规模集群的管理：系统管理员希望分布式应用能更简单的部署和管理</li> <li>庞大运营成本的考量：IT部门希望在硬件成本、软件成本和人力成本能够有大幅度地降低</li></ul></li> <li>为了克服这一问题，NoSQL应运而生，它同时具备了<strong>高性能</strong>、<strong>可扩展性强</strong>、<strong>高可用</strong>等优点，受到广泛开发人员和仓库管理人员的青睐。</li></ul> <h3 id="关系型数据库-rmdbs-与非关系型数据库-nosql-的对比"><a href="#关系型数据库-rmdbs-与非关系型数据库-nosql-的对比" class="header-anchor">#</a> 关系型数据库（RMDBS）与非关系型数据库（NoSQL）的对比</h3> <ul><li>数据库中表与表的数据之间存在某种关联的内在关系，因为这种关系，所以我们称这种数据库为关系型数据库。典型：Mysql/MariaDB、postgreSQL、Oracle、SQLServer、DB2、Access、SQLlite3。特点：
<ul><li>全部使用SQL（结构化查询语言）进行数据库操作。</li> <li>都存在主外键关系，表，等等关系特征。</li> <li>大部分都支持各种关系型的数据库的特性：事务、存储过程、触发器、视图、临时表、模式、函数</li></ul></li> <li>NOSQL：not only sql，泛指非关系型数据库。泛指那些不使用SQL语句进行数据操作的数据库，所有数据库中只要不使用SQL语句的都是非关系型数据库。典型：Redis、MongoDB、hbase、 Hadoop、elasticsearch、图数据库(Neo4j、GraphDB、SequoiaDB)。。。。
<ul><li>每一款都不一样。用途不一致，功能不一致，各有各的操作方式。</li> <li>基本不支持主外键关系，也没有事务的概念。（MongoDB号称最接近关系型数据库的，所以MongoDB有这些的。）</li></ul></li></ul> <h2 id="redis介绍"><a href="#redis介绍" class="header-anchor">#</a> redis介绍</h2> <h3 id="定义"><a href="#定义" class="header-anchor">#</a> 定义</h3> <ul><li>Redis（Remote Dictionary Server ，远程字典服务） 是一个使用ANSI C编写的开源、支持网络、基于内存、可选持久性的键值对存储数据库，是NoSQL数据库。</li> <li>redis的出现主要是为了替代早期的Memcache缓存系统的。map内存型(数据存放在内存中)的非关系型(nosql)key-value(键值存储)数据库， 支持数据的持久化(基于RDB和AOF，注: 数据持久化时将数据存放到文件中，每次启动redis之后会先将文件中数据加载到内存，经常用来做缓存、数据共享、购物车、消息队列、计数器、限流等。(最基本的就是缓存一些经常用到的数据，提高读写速度)。</li></ul> <h3 id="redis特性"><a href="#redis特性" class="header-anchor">#</a> redis特性</h3> <ol><li>速度快</li> <li>持久化</li> <li>多种数据结构</li> <li>支持多种编程语言</li> <li>功能丰富</li> <li>简单：代码短小精悍</li> <li>主从复制</li> <li>高可用、分布式</li></ol> <h3 id="redis解决什么问题-与传统数据库相比"><a href="#redis解决什么问题-与传统数据库相比" class="header-anchor">#</a> Redis解决什么问题（与传统数据库相比）</h3> <ol><li>数据量大访问慢</li> <li>排序、数据分段不好处理
<ul><li>传统数据库order by处理，会考虑索引相关问题</li> <li>分段如select * from table limit 10000,10，本质上还是会查前面的10000行数据，然后取后面的10条，性能糟糕</li></ul></li> <li>业务逻辑不好处理</li> <li>IO的痛</li></ol> <h3 id="redis的应用场景"><a href="#redis的应用场景" class="header-anchor">#</a> Redis的应用场景</h3> <p>Redis 的应用场景包括：缓存系统（“热点”数据：高频读、低频写）、计数器、消息队列系统、排行榜、社交网络和实时系统。</p> <h3 id="redis的数据类型及主要特性"><a href="#redis的数据类型及主要特性" class="header-anchor">#</a> Redis的数据类型及主要特性</h3> <p>Redis提供的数据类型主要分为5种自有类型和一种自定义类型，这5种自有类型包括：String类型、哈希类型、列表类型、集合类型和顺序集合类型。</p> <h2 id="redis环境安装"><a href="#redis环境安装" class="header-anchor">#</a> redis环境安装</h2> <h3 id="下载和安装"><a href="#下载和安装" class="header-anchor">#</a> 下载和安装</h3> <ul><li>下载地址：https://github.com/tporadowski/redis/releases</li> <li>使用以下命令启动redis服务端</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>redis-server C:/tool/redis/redis.windows.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>redis作为windows服务启动方式</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>redis-server --service-install redis.windows.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>启动服务</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>redis-server –service-start
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>停止服务</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>redis-server –service-stop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>如果连接操作redis，可以在终端下，使用以下命令：</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>redis-cli
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ubuntu下安装：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>安装命令：sudo apt-get install -y redis-server
卸载命令：sudo apt-get purge --auto-remove redis-server 
关闭命令：sudo service redis-server stop 
开启命令：sudo service redis-server start 
重启命令：sudo service redis-server restart
配置文件：/etc/redis/redis.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="redis的配置"><a href="#redis的配置" class="header-anchor">#</a> redis的配置</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>cat /etc/redis/redis.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>redis的核心配置选项
<ul><li><p>绑定ip：访问白名单，如果需要远程访问，可将此注释，或绑定1个真实ip</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>bind 127.0.0.1   xx.xx.xx.xx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>端口，默认为6379，并且会每次开机自动启动</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>port 6379
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>是否以守护进程运行</p> <ul><li>如果以守护进程运行，则不会在命令阻塞，类似于服务</li> <li>如果以守护进程运行，则当前终端被阻塞</li> <li>设置为yes表示守护进程，设置为no表示守护进程</li> <li>推荐设置为yes<div class="language- line-numbers-mode"><pre class="language-text"><code>daemonize yes
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul></li> <li><p>RDB持久化的备份策略（RDB备份是默认开启的，Redis默认会保存内存数据到磁盘，如果只是把Redis作为缓存使用，这样就会影响性能。）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> # save 时间 读写次数
 save 900 1     # 当redis在900内至少有1次读写操作，则触发一次数据库的备份操作
 save 300 10    # 当redis在300内至少有10次读写操作，则触发一次数据库的备份操作
 save 60 10000  # 当redis在60内至少有10000次读写操作，则触发一次数据库的备份操作
 注释掉以上三行，即作为缓存使用
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>RDB持久化的备份文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>dbfilename dump.rdb
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>RDB持久化数据库数据文件的所在目录</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>dir /var/lib/redis
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>日志文件所载目录</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>loglevel notice
logfile /var/log/redis/redis-server.log
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>进程ID文件</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>pidfile /var/run/redis/redis-server.pid
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>数据库，默认有16个，数据名是不能自定义的，只能是0-15之间，当然这个15是数据库数量-1</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>database 16
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>redis的登录密码，生产阶段打开，开发阶段避免麻烦，一般都是注释的。redis在6.0版本以后新增了ACL访问控制机制，新增了用户管理，这个版本以后才有账号和密码，再次之前只有没有密码没有账号</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># requirepass foobared
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>注意：开启了以后，redis-cli终端下使用 auth 密码来认证登录。</li></ul></li> <li><p>AOF持久化的开启配置项(默认值是no，关闭状态)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>appendonly no
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>AOF持久化的备份文件（AOF的备份数据文件与RDB的备份数据文件保存在同一个目录下，由dir配置项指定）</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>appendfilename &quot;appendonly.aof&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>AOF持久化备份策略[时间]</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># appendfsync always
appendfsync everysec    # 工作中最常用。每一秒备份一次
# appendfsync no
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>哨兵集群：一主二从三哨兵(3台服务器)</p></li> <li><p>更改后需要重启 Redis服务，使修改后的配置生效！</p></li></ul></li></ul> <h3 id="redis的使用"><a href="#redis的使用" class="header-anchor">#</a> Redis的使用</h3> <ul><li>redis是一款基于CS架构的数据库，所以redis有客户端redis-cli，也有服务端redis-server。</li> <li>其中，客户端可以使用go、java、python等编程语言，也可以终端下使用命令行工具管理redis数据库，甚至可以安装一些别人开发的界面工具，例如：RDM。</li> <li>redis-cli客户端连接服务器：</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code># redis-cli -h `redis服务器ip` -p `redis服务器port`
redis-cli -h 10.16.244.3 -p 6379
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="redis数据类型"><a href="#redis数据类型" class="header-anchor">#</a> redis数据类型</h2> <ul><li>redis可以理解成一个全局的大字典，key就是数据的唯一标识符。根据key对应的值不同，可以划分成5个基本数据类型。</li></ul> <h3 id="string类型"><a href="#string类型" class="header-anchor">#</a> string类型:</h3> <ul><li>字符串类型，是 Redis 中最为基础的数据存储类型，它在 Redis 中是二进制安全的，也就是byte类型。</li> <li>单个数据的最大容量是512M。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>key: 值
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>GET/MGET
SET/SETEX/MSET/MSETNX
INCR/DECR
GETSET
DEL
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="设置键值"><a href="#设置键值" class="header-anchor">#</a> 设置键值</h4> <ul><li>set 设置的数据没有额外操作时，是不会过期的。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>set key value
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>设置键为name值为yuan的数据，一个变量可以设置多次</li> <li>注意：redis中的所有数据操作，如果设置的键不存在则为添加，如果设置的键已经存在则修改。</li> <li>设置一个键，当键不存在时才能设置成功，用于一个变量只能被设置一次的情况。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>setnx  key  value
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>一般用于给数据加锁(分布式锁)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>127.0.0.1:6379&gt; setnx goods_1 101
(integer) 1
127.0.0.1:6379&gt; setnx goods_1 102
(integer) 0  # 表示设置不成功

127.0.0.1:6379&gt; del goods_1
(integer) 1
127.0.0.1:6379&gt; setnx goods_1 102
(integer) 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="设置键值的过期时间"><a href="#设置键值的过期时间" class="header-anchor">#</a> 设置键值的过期时间</h4> <p>redis中可以对一切的数据进行设置有效期。以秒为单位</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>setex key seconds value
setex key1 10 value1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="设置多个键值"><a href="#设置多个键值" class="header-anchor">#</a> 设置多个键值</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>mset key1 value1 key2 value2 ...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="字符串拼接值"><a href="#字符串拼接值" class="header-anchor">#</a> 字符串拼接值</h4> <p>常见于大文件上传</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>127.0.0.1:6379&gt; set title &quot;my&quot;
OK
127.0.0.1:6379&gt; append title &quot;book&quot;
(integer) 6
127.0.0.1:6379&gt; append title &quot;is&quot;
(integer) 8
127.0.0.1:6379&gt; append title &quot;python-redis&quot;
(integer) 20
127.0.0.1:6379&gt; get title
&quot;mybookispython-redis&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="根据键获取值"><a href="#根据键获取值" class="header-anchor">#</a> 根据键获取值</h4> <p>根据键获取值，如果不存在此键则返回nil</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>get key
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>根据多个键获取多个值</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mget key1 key2 ...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>getset：设置key的新值，返回旧值</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>127.0.0.1:6379&gt; getset name haha
&quot;liuly2&quot;
127.0.0.1:6379&gt; get name
&quot;haha&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="自增自减"><a href="#自增自减" class="header-anchor">#</a> 自增自减</h4> <p>web开发中的电商抢购、秒杀。游戏里面的投票、攻击计数。系统中计算当前在线人数、</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>127.0.0.1:6379&gt; set id 10
OK
127.0.0.1:6379&gt; incr id
(integer) 11
127.0.0.1:6379&gt; get id
&quot;11&quot;
127.0.0.1:6379&gt; decr id
(integer) 10
127.0.0.1:6379&gt; get id
&quot;10&quot;
127.0.0.1:6379&gt;
127.0.0.1:6379&gt; incrby id 10  # 自增自减大于1的值时候用incrby
(integer) 20
127.0.0.1:6379&gt; get id
&quot;20&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="获取字符串的长度"><a href="#获取字符串的长度" class="header-anchor">#</a> 获取字符串的长度</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>set name xiaoming
strlen name  # 8 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="比特流操作"><a href="#比特流操作" class="header-anchor">#</a> 比特流操作</h4> <ul><li>1字节=8比特 1kb = 1024字节 1mb = 1024kb 1gb = 1024mb</li> <li>1个int8就是一个字节，一个中文：3个字节</li> <li>签到记录</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>SETBIT     # 设置一个bit数据的值 
GETBIT     # 获取一个bit数据的值
BITCOUNT   # 统计字符串被设置为1的bit数.
BITPOS     # 返回字符串里面第一个被设置为1或者0的bit位。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="hash类型"><a href="#hash类型" class="header-anchor">#</a> hash类型</h3> <p>哈希类型，用于存储对象/字典，对象/字典的结构为键值对。key、域、值的类型都为string。域在同一个hash中是唯一的。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>结构：
键key:{
    域field: 值value,
    域field: 值value,
    域field: 值value,
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="设置指定键的属性-域"><a href="#设置指定键的属性-域" class="header-anchor">#</a> 设置指定键的属性/域</h4> <p>设置指定键的单个属性</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hset key field value
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="获取指定键的域-属性的值"><a href="#获取指定键的域-属性的值" class="header-anchor">#</a> 获取指定键的域/属性的值</h4> <p>获取指定键所有的域/属性</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>hkeys key
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="获取指定键的单个域-属性的值"><a href="#获取指定键的单个域-属性的值" class="header-anchor">#</a> 获取指定键的单个域/属性的值</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>hget key field
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="获取指定键的多个域-属性的值"><a href="#获取指定键的多个域-属性的值" class="header-anchor">#</a> 获取指定键的多个域/属性的值</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>hmget key field1 field2 ...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="获取指定键的所有值"><a href="#获取指定键的所有值" class="header-anchor">#</a> 获取指定键的所有值</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>hvals key
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="获取hash的所有域值对"><a href="#获取hash的所有域值对" class="header-anchor">#</a> 获取hash的所有域值对</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>hgetall title
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="删除指定键的域-属性"><a href="#删除指定键的域-属性" class="header-anchor">#</a> 删除指定键的域/属性</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>hdel key field1 field2 ...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="判断指定属性-域是否存在于当前键对应的hash中"><a href="#判断指定属性-域是否存在于当前键对应的hash中" class="header-anchor">#</a> 判断指定属性/域是否存在于当前键对应的hash中</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>hexists   key  field
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="属性值自增自减"><a href="#属性值自增自减" class="header-anchor">#</a> 属性值自增自减</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>hincrby key field number
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="list类型"><a href="#list类型" class="header-anchor">#</a> list类型</h3> <ul><li>队列，列表的子成员类型为string</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>key: [值1，值2, 值3.....]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="添加子成员"><a href="#添加子成员" class="header-anchor">#</a> 添加子成员</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code># 在左侧(前)添加一条或多条数据
lpush key value1 value2 ...

# 在右侧(后)添加一条或多条数据
rpush key value1 value2 ...

# 在指定元素的左边(前)/右边（后）插入一个或多个数据
linsert key before 指定元素 value1 value2 ....
linsert key after 指定元素 value1 value2 ....
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>注意：当列表如果存在多个成员的情况下，默认只识别第一个。</p> <h4 id="获取列表成员"><a href="#获取列表成员" class="header-anchor">#</a> 获取列表成员</h4> <p>根据指定的索引(下标)获取成员的值，负数下标从右边-1开始，逐个递减</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>lindex key index
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>移除并获取列表的第一个成员或最后一个成员</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>lpop key  # 第一个成员出列
rpop key  # 最后一个成员出列
# 开发中往往使用rpush和lpop实现队列的数据结构-&gt;实现入列和出列
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="获取列表的切片"><a href="#获取列表的切片" class="header-anchor">#</a> 获取列表的切片</h4> <p>闭区间[包括stop]</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>lrange key start stop
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="获取列表的长度"><a href="#获取列表的长度" class="header-anchor">#</a> 获取列表的长度</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>llen key
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="按索引设置值"><a href="#按索引设置值" class="header-anchor">#</a> 按索引设置值</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>lset key index value
# redis的列表也有索引，从左往右，从0开始，逐一递增，第1个元素下标为0
# 索引可以是负数，表示尾部开始计数，如`-1`表示最后1个元素
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="删除指定成员"><a href="#删除指定成员" class="header-anchor">#</a> 删除指定成员</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>lrem key count value
# count表示删除的数量，value表示要删除的成员。该命令默认表示将列表从左侧前count个value的元素移除
# count==0，表示删除列表所有值为value的成员
# count &gt;0，表示删除列表左侧开始的前count个value成员
# count &lt;0，表示删除列表右侧开始的前count个value成员
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="set类型"><a href="#set类型" class="header-anchor">#</a> set类型</h3> <p>无序集合，它的子成员类型为string类型，元素唯一不重复，没有修改操作，重点就是去重和无序。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>key: {值1, 值4, 值3, ...., 值5}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="添加元素"><a href="#添加元素" class="header-anchor">#</a> 添加元素</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>sadd key member1 member2 ...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="获取集合的所有的成员"><a href="#获取集合的所有的成员" class="header-anchor">#</a> 获取集合的所有的成员</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>smembers key
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="获取集合的长度"><a href="#获取集合的长度" class="header-anchor">#</a> 获取集合的长度</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>scard keys 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="随机抽取一个或多个元素"><a href="#随机抽取一个或多个元素" class="header-anchor">#</a> 随机抽取一个或多个元素</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>spop key [count=1]
# count为可选参数，不填则默认一个。被提取成员会从集合中被删除掉
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="删除指定元素"><a href="#删除指定元素" class="header-anchor">#</a> 删除指定元素</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>srem key value
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="交集、差集和并集"><a href="#交集、差集和并集" class="header-anchor">#</a> 交集、差集和并集</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>sinter  key1 key2 key3 ....    # 交集、比较多个集合中共同存在的成员
sdiff   key1 key2 key3 ....    # 差集、比较多个集合中不同的成员
sunion  key1 key2 key3 ....    # 并集、合并所有集合的成员，并去重
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="zset类型-sortedset"><a href="#zset类型-sortedset" class="header-anchor">#</a> zset类型(sortedSet)</h3> <p>有序集合，它的子成员值的类型为string类型，元素唯一不重复，没有修改操作。权重值(score,分数)从小到大排列。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>key: {
	值1 权重值1(数字);
	值2 权重值2;
	值3 权重值3;
	值4 权重值4;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="添加成员"><a href="#添加成员" class="header-anchor">#</a> 添加成员</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>zadd key score1 member1 score2 member2 score3 member3 ....
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="获取score在指定区间的所有成员"><a href="#获取score在指定区间的所有成员" class="header-anchor">#</a> 获取score在指定区间的所有成员</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>zrangebyscore key min max     # 按score进行从低往高排序获取指定score区间
zrevrangebyscore key min max  # 按score进行从高往低排序获取指定score区间
zrange key start stop         # 按scoer进行从低往高排序获取指定索引区间
zrevrange key start stop      # 按scoer进行从高往低排序获取指定索引区间
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="获取集合长度"><a href="#获取集合长度" class="header-anchor">#</a> 获取集合长度</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>zcard key
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="获取指定成员的权重值"><a href="#获取指定成员的权重值" class="header-anchor">#</a> 获取指定成员的权重值</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>zscore key member
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="获取指定成员在集合中的排名"><a href="#获取指定成员在集合中的排名" class="header-anchor">#</a> 获取指定成员在集合中的排名</h4> <p>排名从0开始计算</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>zrank key member      # score从小到大的排名
zrevrank key member   # score从大到小的排名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="获取score在指定区间的所有成员数量"><a href="#获取score在指定区间的所有成员数量" class="header-anchor">#</a> 获取score在指定区间的所有成员数量</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>zcount key min max
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="给指定成员增加增加权重值"><a href="#给指定成员增加增加权重值" class="header-anchor">#</a> 给指定成员增加增加权重值</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>zincrby key score member
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="删除成员"><a href="#删除成员" class="header-anchor">#</a> 删除成员</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>zrem key member1 member2 member3 ....
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="删除指定数量的成员"><a href="#删除指定数量的成员" class="header-anchor">#</a> 删除指定数量的成员</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code># 删除指定数量的成员，从最低score开始删除
zpopmin key [count]
# 删除指定数量的成员，从最高score开始删除
zpopmax key [count]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="使用场景"><a href="#使用场景" class="header-anchor">#</a> 使用场景</h3> <ul><li>字符串string: 用于保存项目中普通数据，只要键值对都可以保存，例如，保存 session/jwt,定时记录状态，倒计时、验证码、防灌水答案</li> <li>哈希hash：用于保存项目中的一些结构体/map类型数据，但是不能保存多维结构，例如，商城的购物车，文章信息，json结构数据</li> <li>列表list：用于保存项目中的列表/切片数据，但是也不能保存多维结构，例如，消息队列，秒杀系统，排队，</li> <li>无序集合set: 用于保存项目中的一些不能重复的数据，可以用于过滤，例如，候选人名单, 作者名单，</li> <li>有序集合zset：用于保存项目中一些不能重复，但是需要进行排序的数据,例如：分数排行榜, 海选人排行榜，热搜排行，</li></ul> <h3 id="任何数据类型都通用的命令"><a href="#任何数据类型都通用的命令" class="header-anchor">#</a> 任何数据类型都通用的命令</h3> <h4 id="查找键"><a href="#查找键" class="header-anchor">#</a> 查找键</h4> <p>参数支持简单的正则表达式</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>keys pattern
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查看所有键</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>keys *
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code># 查看名称中包含`a`的键
keys *a*
# 查看以a开头的键
keys a*
# 查看以a结尾的键
keys *a
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="判断键是否存在"><a href="#判断键是否存在" class="header-anchor">#</a> 判断键是否存在</h4> <p>如果存在返回1，不存在返回0</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>exists key1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="查看键的的值的数据类型"><a href="#查看键的的值的数据类型" class="header-anchor">#</a> 查看键的的值的数据类型</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>type key
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="删除键以及键对应的值"><a href="#删除键以及键对应的值" class="header-anchor">#</a> 删除键以及键对应的值</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>del key1 key2 ...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="查看键的有效期"><a href="#查看键的有效期" class="header-anchor">#</a> 查看键的有效期</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>ttl key
# 结果结果是秒作为单位的整数
# -1 表示永不过期
# -2 表示当前数据已经过期，查看一个不存在的数据的有效期就是-2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="设置key的有效期"><a href="#设置key的有效期" class="header-anchor">#</a> 设置key的有效期</h4> <p>给已有的数据重新设置有效期，redis中所有的数据都可以通过expire来设置它的有效期。有效期到了，数据就被删除。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>expire key seconds
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="清空所有key"><a href="#清空所有key" class="header-anchor">#</a> 清空所有key</h4> <p>慎用，一旦执行，则redis所有数据库0~15的全部key都会被清除</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>flushall
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="key重命名"><a href="#key重命名" class="header-anchor">#</a> key重命名</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>rename  oldkey newkey
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="select切换数据库"><a href="#select切换数据库" class="header-anchor">#</a> select切换数据库</h4> <p>redis的配置文件中，默认有0~15之间的16个数据库，默认操作的就是0号数据库</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>select &lt;数据库ID&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="python操作redis"><a href="#python操作redis" class="header-anchor">#</a> Python操作redis</h2> <h3 id="python对redis基本操作"><a href="#python对redis基本操作" class="header-anchor">#</a> python对redis基本操作</h3> <h4 id="连接redis"><a href="#连接redis" class="header-anchor">#</a> 连接redis</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code># 方式1
import redis

r = redis.Redis(host='127.0.0.1', port=6379)
r.set('foo', 'Bar')
print(r.get('foo'))

# 方式2
import redis

pool = redis.ConnectionPool(host='127.0.0.1', port=6379)
r = redis.Redis(connection_pool=pool)
r.set('bar', 'Foo')
print(r.get('bar'))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>通常情况下, 当我们需要做redis操作时, 会创建一个连接, 并基于这个连接进行redis操作, 操作完成后, 释放连接,一般情况下, 这是没问题的, 但当并发量比较高的时候, 频繁的连接创建和释放对性能会有较高的影响。于是, 连接池就发挥作用了。连接池的原理是, 通过预先创建多个连接, 当进行redis操作时, 直接获取已经创建的连接进行操作, 而且操作完成后, 不会释放, 用于后续的其他redis操作。这样就达到了避免频繁的redis连接创建和释放的目的, 从而提高性能。</p> <h4 id="数据类型操作"><a href="#数据类型操作" class="header-anchor">#</a> 数据类型操作</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>import redis

pool = redis.ConnectionPool(host='127.0.0.1', port=6379, db=0, decode_responses=True)
r = redis.Redis(connection_pool=pool)

# （1）字符串操作：不允许对已经存在的键设置值
ret = r.setnx(&quot;name&quot;, &quot;yuan&quot;)
print(ret)  # False
# （2）字符串操作：设置键有效期
r.setex(&quot;good_1001&quot;, 10, &quot;2&quot;)
# （3）字符串操作：自增自减
r.set(&quot;age&quot;, 20)
r.incrby(&quot;age&quot;, 2)
print(r.get(&quot;age&quot;))  # b'22'

# （4）hash操作：设置hash
r.hset(&quot;info&quot;, &quot;name&quot;, &quot;rain&quot;)
print(r.hget(&quot;info&quot;, &quot;name&quot;))  # b'rain'
r.hset(&quot;info&quot;, &quot;gender&quot;, &quot;male&quot;, {&quot;age&quot;: 22})
print(r.hgetall(&quot;info&quot;))  # {b'name': b'rain', b'gender': b'male', b'age': b'22'}

# （5）list操作：设置list
r.rpush(&quot;scores&quot;, &quot;100&quot;, &quot;90&quot;, &quot;80&quot;)
r.rpush(&quot;scores&quot;, &quot;70&quot;)
r.lpush(&quot;scores&quot;, &quot;120&quot;)
print(r.lrange(&quot;scores&quot;, 0, -1))  # ['120', '100', '90', '80', '70']
r.linsert(&quot;scores&quot;, &quot;AFTER&quot;, &quot;100&quot;, 95)
print(r.lrange(&quot;scores&quot;, 0, -1))  # ['120', '100', '95', '90', '80', '70']
print(r.lpop(&quot;scores&quot;))  # 120
print(r.rpop(&quot;scores&quot;))  # 70
print(r.lindex(&quot;scores&quot;, 1)) # '95'

# （6）集合操作
# key对应的集合中添加元素
r.sadd(&quot;name_set&quot;, &quot;zhangsan&quot;, &quot;lisi&quot;, &quot;wangwu&quot;)
# 获取key对应的集合的所有成员
print(r.smembers(&quot;name_set&quot;))  # {'lisi', 'zhangsan', 'wangwu'}
# 从key对应的集合中随机获取 numbers 个元素
print(r.srandmember(&quot;name_set&quot;, 2))
r.srem(&quot;name_set&quot;, &quot;lisi&quot;)
print(r.smembers(&quot;name_set&quot;))  # {'wangwu', 'zhangsan'}

# （7）有序集合操作
# 在key对应的有序集合中添加元素
r.zadd(&quot;jifenbang&quot;, {&quot;yuan&quot;: 78, &quot;rain&quot;: 20, &quot;alvin&quot;: 89, &quot;eric&quot;: 45})
# 按照索引范围获取key对应的有序集合的元素
# zrange( name, start, end, desc=False, withscores=False, score_cast_func=float)
print(r.zrange(&quot;jifenbang&quot;, 0, -1))  # ['rain', 'eric', 'yuan', 'alvin']
print(r.zrange(&quot;jifenbang&quot;, 0, -1, withscores=True))  # ['rain', 'eric', 'yuan', 'alvin']
print(r.zrevrange(&quot;jifenbang&quot;, 0, -1, withscores=True))  # ['rain', 'eric', 'yuan', 'alvin']

print(r.zrangebyscore(&quot;jifenbang&quot;, 0, 100))
print(r.zrangebyscore(&quot;jifenbang&quot;, 0, 100, start=0, num=1))

# 删除key对应的有序集合中值是values的成员
print(r.zrem(&quot;jifenbang&quot;, &quot;yuan&quot;))  # 删除成功返回1
print(r.zrange(&quot;jifenbang&quot;, 0, -1))  # ['rain', 'eric', 'alvin']

# （8）键操作
r.delete(&quot;scores&quot;)
print(r.exists(&quot;scores&quot;))
print(r.keys(&quot;*&quot;))
r.expire(&quot;name&quot;,10)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><h3 id="redis案例"><a href="#redis案例" class="header-anchor">#</a> redis案例</h3> <h4 id="kv缓存"><a href="#kv缓存" class="header-anchor">#</a> KV缓存</h4> <p><img src="/assets/img/uTools_1653744188860.28f13f6b.png" alt="">
第一个是最基础也是最常见的就是KV功能，我们可以用Redis来缓存用户信息、会话信息、商品信息等等。下面这段代码就是通过缓存读取逻辑。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>import redis

pool = redis.ConnectionPool(host='127.0.0.1', port=6379, db=6, decode_responses=True)
r = redis.Redis(connection_pool=pool)

def get_user(user_id):
    user = r.get(user_id)
    if not user:
        user = UserInfo.objects.get(pk=user_id)
        r.setex(user_id, 3600, user)
    return user
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="分布式锁"><a href="#分布式锁" class="header-anchor">#</a> 分布式锁</h4> <ul><li>什么是分布式锁
<ul><li>分布式锁其实就是，控制分布式系统不同进程共同访问共享资源的一种锁的实现。如果不同的系统或同一个系统的不同主机之间共享了某个临界资源，往往需要互斥来防止彼此干扰，以保证一致性。</li></ul></li> <li>提到Redis的分布式锁，很多小伙伴马上就会想到setnx+ expire命令。即先用setnx来抢锁，如果抢到之后，再用expire给锁设置一个过期时间，防止锁忘记了释放。
<ul><li>SETNX 是SET IF NOT EXISTS的简写.日常命令格式是SETNX key value，如果 key不存在，则SETNX成功返回1，如果这个key已经存在了，则返回0。</li></ul></li> <li>假设某电商网站的某商品做秒杀活动，key可以设置为key_resource_id,value设置任意值，伪代码如下：</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>方案1
import redis

pool = redis.ConnectionPool(host='127.0.0.1')
r = redis.Redis(connection_pool=pool)
ret = r.setnx(&quot;key_resource_id&quot;, &quot;ok&quot;)
if ret:
    r.expire(&quot;key_resource_id&quot;, 5)  # 设置过期时间
    print(&quot;抢购成功！&quot;)
    r.delete(&quot;key_resource_id&quot;)  # 释放资源
else:
    print(&quot;抢购失败！&quot;)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li>但是这个方案中，setnx和expire两个命令分开了，「不是原子操作」。如果执行完setnx加锁，正要执行expire设置过期时间时，进程crash或者要重启维护了，那么这个锁就“长生不老”了，「别的线程永远获取不到锁啦」。</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>方案2：SETNX + value值是(系统时间+过期时间)
为了解决方案一，「发生异常锁得不到释放的场景」，可以把过期时间放到setnx的value值里面。如果加锁失败，再拿出value值校验一下即可。加锁代码如下：
import time

def foo():
    expiresTime = time.time() + 10
    ret = r.setnx(&quot;key_resource_id&quot;, expiresTime)
    if ret:
        print(&quot;当前锁不存在，加锁成功&quot;)
        return True
    oldExpiresTime = r.get(&quot;key_resource_id&quot;)
    if float(oldExpiresTime) &lt; time.time():  # 如果获取到的过期时间，小于系统当前时间，表示已经过期
        # 锁已过期，获取上一个锁的过期时间，并设置现在锁的过期时间
        newExpiresTime = r.getset(&quot;key_resource_id&quot;, expiresTime)
        if oldExpiresTime == newExpiresTime:
            #  考虑多线程并发的情况，只有一个线程的设置值和当前值相同，它才可以加锁
            return True  # 加锁成功
    return False  # 其余情况加锁皆失败

foo()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>方案3
实际上，我们还可以使用Py的redis模块中的set函数来保证原子性（包含setnx和expire两条指令）代码如下：
r.set(&quot;key_resource_id&quot;, &quot;1&quot;, nx=True, ex=10)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="定时任务"><a href="#定时任务" class="header-anchor">#</a> 定时任务</h4> <p>利用 Redis 也能实现订单30分钟自动取消。
用户下单之后，在规定时间内如果不完成付款，订单自动取消，并且释放库存使用技术：Redis键空间通知（过期回调）用户下单之后将订单id作为key，任意值作为值存入redis中，给这条数据设置过期时间，也就是订单超时的时间启用键空间通知</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>from redis import StrictRedis

redis = StrictRedis(host='localhost', port=6379)

# 监听所有事件
# pubsub = redis.pubsub()
# pubsub.psubscribe('__keyspace@0__:*')
# print('Starting message loop')
# while True:
#     message = pubsub.get_message()
#     if message:
#         print(message)

# 监听过期key
def event_handler(msg):
    print(&quot;sss&quot;,msg)
    thread.stop()

pubsub = redis.pubsub()
pubsub.psubscribe(**{'__keyevent@0__:expired': event_handler})
thread = pubsub.run_in_thread(sleep_time=0.01)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h4 id="延迟队列"><a href="#延迟队列" class="header-anchor">#</a> 延迟队列</h4> <p>延时队列可以通过Redis的zset(有序列表)来实现。我们将消息序列化为一个字符串作为zset的值。这个消息的到期时间处理时间作为score，然后用多个线程轮询zset获取到期的任务进行处理，多线程时为了保障可用性，万一挂了一个线程还有其他线程可以继续处理。因为有多个线程，所有需要考虑并发争抢任务，确保任务不能被多次执行。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>import time
import uuid
import redis

pool = redis.ConnectionPool(host='127.0.0.1', port=6379, decode_responses=True)
r = redis.Redis(connection_pool=pool)

def delay_task(task_name, delay_time):
    # 保证value唯一
    task_id = task_name + str(uuid.uuid4())
    print()
    # 5s后重试
    retry_ts = time.time() + delay_time
    r.zadd(&quot;delay-queue&quot;, {task_id: retry_ts})

def loop():
    print(&quot;循环监听中...&quot;)
    while True:
        # 最多取1条
        task_list = r.zrangebyscore(&quot;delay-queue&quot;, 0, time.time(), start=0, num=1)
        if not task_list:
            # 延时队列空的，休息1s
            print(&quot;cost 1秒钟&quot;)
            time.sleep(1)
            continue
        task_id = task_list[0]
        success = r.zrem(&quot;delay-queue&quot;, task_id)
        if success:
            # 处理消息逻辑函数
            handle_msg(task_id)

def handle_msg(msg):
    &quot;&quot;&quot;消息处理逻辑&quot;&quot;&quot;
    print(f&quot;消息{msg}已经被处理完成！&quot;)

import threading
t = threading.Thread(target=loop)
t.start()

delay_task(&quot;任务1延迟5&quot;, 5)
delay_task(&quot;任务2延迟2&quot;, 2)
delay_task(&quot;任务3延迟3&quot;, 3)
delay_task(&quot;任务4延迟10&quot;, 10)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><ul><li>redis的zrem方法是对多线程争抢任务的关键，它的返回值决定了当前实例有没有抢到任务，因为loop方法可能会被多个线程、多个进程调用， 同一个任务可能会被多个进程线程抢到，通过zrem来决定唯一的属主。</li> <li>同时，一定要对handle_msg进行异常捕获， 避免因为个别任务处理问题导致的循环异常退出。</li></ul> <h4 id="发布订阅"><a href="#发布订阅" class="header-anchor">#</a> 发布订阅</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>import threading
import redis

r = redis.Redis(host='127.0.0.1')

def recv_msg():
    pub = r.pubsub()
    pub.subscribe(&quot;fm104.5&quot;)
    pub.parse_response()
    while 1:
        msg = pub.parse_response()
        print(msg)

def send_msg():
    msg = input(&quot;&gt;&gt;&gt;&quot;)
    r.publish(&quot;fm104.5&quot;, msg)

t = threading.Thread(target=send_msg)
t.start()
recv_msg()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="redis测试场景"><a href="#redis测试场景" class="header-anchor">#</a> Redis测试场景</h2> <ol><li>redis数据生效时，读取是否正确</li> <li>redis数据不存在时，能否正常从db读取到正确值，并写入redis和返回给前端</li> <li>数据在redis和db都不存在时表现是否正常</li> <li>删除数据时，redis和db数据是否一致</li></ol> <h3 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h3> <ul><li><a href="http://www.yuan316.com/post/redis/" target="_blank" rel="noopener noreferrer">http://www.yuan316.com/post/redis/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://redis.io/" target="_blank" rel="noopener noreferrer">Redis官方原版<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://www.redis.cn" target="_blank" rel="noopener noreferrer">Redis中文官网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/backend/redis/Redis架构演化之路.html">
        Redis架构演化之路
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.dd60fddf.js" defer></script><script src="/assets/js/2.1d799614.js" defer></script><script src="/assets/js/27.357c2f0c.js" defer></script>
  </body>
</html>
