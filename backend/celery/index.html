<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>杏壳儿</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.5675a7d7.css" as="style"><link rel="preload" href="/assets/js/app.dd60fddf.js" as="script"><link rel="preload" href="/assets/js/2.1d799614.js" as="script"><link rel="preload" href="/assets/js/18.bb46f976.js" as="script"><link rel="prefetch" href="/assets/js/10.f42a5970.js"><link rel="prefetch" href="/assets/js/100.fd420176.js"><link rel="prefetch" href="/assets/js/101.fd3f9957.js"><link rel="prefetch" href="/assets/js/102.d3c4087c.js"><link rel="prefetch" href="/assets/js/103.5bf5f364.js"><link rel="prefetch" href="/assets/js/104.c19dc6fc.js"><link rel="prefetch" href="/assets/js/105.3644a723.js"><link rel="prefetch" href="/assets/js/106.c99225f8.js"><link rel="prefetch" href="/assets/js/107.97852924.js"><link rel="prefetch" href="/assets/js/108.212c27f0.js"><link rel="prefetch" href="/assets/js/109.d6e4c811.js"><link rel="prefetch" href="/assets/js/11.91f395ed.js"><link rel="prefetch" href="/assets/js/110.96b9b201.js"><link rel="prefetch" href="/assets/js/111.78b25fde.js"><link rel="prefetch" href="/assets/js/112.8c82f9a4.js"><link rel="prefetch" href="/assets/js/113.aae564aa.js"><link rel="prefetch" href="/assets/js/114.313f0d5b.js"><link rel="prefetch" href="/assets/js/115.844f47cf.js"><link rel="prefetch" href="/assets/js/116.4d2691a0.js"><link rel="prefetch" href="/assets/js/117.bd36d4a2.js"><link rel="prefetch" href="/assets/js/118.d205f7e7.js"><link rel="prefetch" href="/assets/js/119.ee336fe8.js"><link rel="prefetch" href="/assets/js/12.5e7abec9.js"><link rel="prefetch" href="/assets/js/120.f5ba9dbe.js"><link rel="prefetch" href="/assets/js/121.05e1c205.js"><link rel="prefetch" href="/assets/js/122.779c5f8c.js"><link rel="prefetch" href="/assets/js/123.64ad1fde.js"><link rel="prefetch" href="/assets/js/124.72120675.js"><link rel="prefetch" href="/assets/js/125.7f1e0958.js"><link rel="prefetch" href="/assets/js/126.dcd28d9f.js"><link rel="prefetch" href="/assets/js/127.428f223e.js"><link rel="prefetch" href="/assets/js/128.0ebf700a.js"><link rel="prefetch" href="/assets/js/129.3d7442ee.js"><link rel="prefetch" href="/assets/js/13.ec7d048b.js"><link rel="prefetch" href="/assets/js/130.b946546b.js"><link rel="prefetch" href="/assets/js/131.0ea40481.js"><link rel="prefetch" href="/assets/js/132.4a4437c1.js"><link rel="prefetch" href="/assets/js/133.7e17bb00.js"><link rel="prefetch" href="/assets/js/134.95928b65.js"><link rel="prefetch" href="/assets/js/135.fb730cc9.js"><link rel="prefetch" href="/assets/js/136.ce2e6b16.js"><link rel="prefetch" href="/assets/js/137.30dda982.js"><link rel="prefetch" href="/assets/js/138.9d9bd5df.js"><link rel="prefetch" href="/assets/js/139.19e62986.js"><link rel="prefetch" href="/assets/js/14.27407a31.js"><link rel="prefetch" href="/assets/js/140.425bbd4e.js"><link rel="prefetch" href="/assets/js/141.13f9ac88.js"><link rel="prefetch" href="/assets/js/142.b12b14dc.js"><link rel="prefetch" href="/assets/js/15.3653047a.js"><link rel="prefetch" href="/assets/js/16.7baae9f5.js"><link rel="prefetch" href="/assets/js/17.dcad52cb.js"><link rel="prefetch" href="/assets/js/19.0925b886.js"><link rel="prefetch" href="/assets/js/20.e2181917.js"><link rel="prefetch" href="/assets/js/21.2e00fc64.js"><link rel="prefetch" href="/assets/js/22.60af365a.js"><link rel="prefetch" href="/assets/js/23.9a6247e9.js"><link rel="prefetch" href="/assets/js/24.533a55d3.js"><link rel="prefetch" href="/assets/js/25.0d54429f.js"><link rel="prefetch" href="/assets/js/26.f70e7a58.js"><link rel="prefetch" href="/assets/js/27.357c2f0c.js"><link rel="prefetch" href="/assets/js/28.05884156.js"><link rel="prefetch" href="/assets/js/29.b63f5d12.js"><link rel="prefetch" href="/assets/js/3.b3c0c8cc.js"><link rel="prefetch" href="/assets/js/30.c37379b8.js"><link rel="prefetch" href="/assets/js/31.e5583500.js"><link rel="prefetch" href="/assets/js/32.2f8a89ce.js"><link rel="prefetch" href="/assets/js/33.8526b5cc.js"><link rel="prefetch" href="/assets/js/34.8c476ba1.js"><link rel="prefetch" href="/assets/js/35.28a9e848.js"><link rel="prefetch" href="/assets/js/36.22caee50.js"><link rel="prefetch" href="/assets/js/37.f564431c.js"><link rel="prefetch" href="/assets/js/38.60510a45.js"><link rel="prefetch" href="/assets/js/39.b57d73b7.js"><link rel="prefetch" href="/assets/js/4.6dd544f6.js"><link rel="prefetch" href="/assets/js/40.a0f12257.js"><link rel="prefetch" href="/assets/js/41.ae21b83f.js"><link rel="prefetch" href="/assets/js/42.4a8b0eed.js"><link rel="prefetch" href="/assets/js/43.a4b1dbe5.js"><link rel="prefetch" href="/assets/js/44.7957e7b8.js"><link rel="prefetch" href="/assets/js/45.22f92df5.js"><link rel="prefetch" href="/assets/js/46.a7bd57b2.js"><link rel="prefetch" href="/assets/js/47.1076bbe9.js"><link rel="prefetch" href="/assets/js/48.10c8f82d.js"><link rel="prefetch" href="/assets/js/49.aea6f4f0.js"><link rel="prefetch" href="/assets/js/5.7fae9900.js"><link rel="prefetch" href="/assets/js/50.97341023.js"><link rel="prefetch" href="/assets/js/51.2213cc76.js"><link rel="prefetch" href="/assets/js/52.4b1c29e4.js"><link rel="prefetch" href="/assets/js/53.a6434736.js"><link rel="prefetch" href="/assets/js/54.59470ace.js"><link rel="prefetch" href="/assets/js/55.49cec6b6.js"><link rel="prefetch" href="/assets/js/56.06f2e67d.js"><link rel="prefetch" href="/assets/js/57.2e812620.js"><link rel="prefetch" href="/assets/js/58.e6ce6313.js"><link rel="prefetch" href="/assets/js/59.35026211.js"><link rel="prefetch" href="/assets/js/6.8c7a6ec4.js"><link rel="prefetch" href="/assets/js/60.cc2c97a8.js"><link rel="prefetch" href="/assets/js/61.8d91a90f.js"><link rel="prefetch" href="/assets/js/62.991f9147.js"><link rel="prefetch" href="/assets/js/63.85532e4f.js"><link rel="prefetch" href="/assets/js/64.90068745.js"><link rel="prefetch" href="/assets/js/65.ff870427.js"><link rel="prefetch" href="/assets/js/66.ba94b154.js"><link rel="prefetch" href="/assets/js/67.5158a096.js"><link rel="prefetch" href="/assets/js/68.54fe2ba5.js"><link rel="prefetch" href="/assets/js/69.bcb4c73f.js"><link rel="prefetch" href="/assets/js/7.3c7e6d86.js"><link rel="prefetch" href="/assets/js/70.00d41657.js"><link rel="prefetch" href="/assets/js/71.892ff6f5.js"><link rel="prefetch" href="/assets/js/72.2302172b.js"><link rel="prefetch" href="/assets/js/73.02125fde.js"><link rel="prefetch" href="/assets/js/74.23ba9330.js"><link rel="prefetch" href="/assets/js/75.c6915e81.js"><link rel="prefetch" href="/assets/js/76.f26b5808.js"><link rel="prefetch" href="/assets/js/77.e9b2145e.js"><link rel="prefetch" href="/assets/js/78.41764819.js"><link rel="prefetch" href="/assets/js/79.194bc603.js"><link rel="prefetch" href="/assets/js/8.1788d36a.js"><link rel="prefetch" href="/assets/js/80.4b57cedb.js"><link rel="prefetch" href="/assets/js/81.f9556a24.js"><link rel="prefetch" href="/assets/js/82.f18755ed.js"><link rel="prefetch" href="/assets/js/83.5c9f9489.js"><link rel="prefetch" href="/assets/js/84.5c47e245.js"><link rel="prefetch" href="/assets/js/85.1b40b497.js"><link rel="prefetch" href="/assets/js/86.774be43b.js"><link rel="prefetch" href="/assets/js/87.f2848ddb.js"><link rel="prefetch" href="/assets/js/88.0f0b4fab.js"><link rel="prefetch" href="/assets/js/89.2ae8eea2.js"><link rel="prefetch" href="/assets/js/9.c52fca3a.js"><link rel="prefetch" href="/assets/js/90.3e798661.js"><link rel="prefetch" href="/assets/js/91.329942cb.js"><link rel="prefetch" href="/assets/js/92.f6b412ea.js"><link rel="prefetch" href="/assets/js/93.1bad8fe5.js"><link rel="prefetch" href="/assets/js/94.8ab22d8b.js"><link rel="prefetch" href="/assets/js/95.af7ae9bb.js"><link rel="prefetch" href="/assets/js/96.b84c5880.js"><link rel="prefetch" href="/assets/js/97.8584121b.js"><link rel="prefetch" href="/assets/js/98.3d7a6b2a.js"><link rel="prefetch" href="/assets/js/99.da28339e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5675a7d7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/开心果.png" alt="杏壳儿" class="logo"> <span class="site-name can-hide">杏壳儿</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="软件测试体系" class="dropdown-title"><span class="title">软件测试体系</span> <span class="arrow down"></span></button> <button type="button" aria-label="软件测试体系" class="mobile-dropdown-title"><span class="title">软件测试体系</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/qa/basics/" class="nav-link">
  测试基础
</a></li><li class="dropdown-item"><!----> <a href="/qa/automatic/" class="nav-link">
  自动测试
</a></li><li class="dropdown-item"><!----> <a href="/qa/performance/" class="nav-link">
  性能测试
</a></li><li class="dropdown-item"><!----> <a href="/qa/special/" class="nav-link">
  专项测试
</a></li><li class="dropdown-item"><!----> <a href="/qa/security/" class="nav-link">
  安全测试
</a></li><li class="dropdown-item"><!----> <a href="/qa/tool/" class="nav-link">
  测试工具
</a></li><li class="dropdown-item"><!----> <a href="/qa/framework/" class="nav-link">
  测试框架
</a></li><li class="dropdown-item"><!----> <a href="/qa/view/" class="nav-link">
  测试思考
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/basic/network/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/basic/os/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/basic/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/basic/algorithms/" class="nav-link">
  数据结构与算法
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">前端游乐场</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">前端游乐场</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/vue/" class="nav-link">
  VUE
</a></li><li class="dropdown-item"><!----> <a href="/frontend/css/" class="nav-link">
  CSS
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端训练场" class="dropdown-title"><span class="title">后端训练场</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端训练场" class="mobile-dropdown-title"><span class="title">后端训练场</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          编程语言
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/python/" class="nav-link">
  Python
</a></li><li class="dropdown-subitem"><a href="/backend/java/" class="nav-link">
  Java
</a></li></ul></li><li class="dropdown-item"><h4>
          WEB框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/django/" class="nav-link">
  Django
</a></li><li class="dropdown-subitem"><a href="/backend/drf/" class="nav-link">
  Django REST Framework
</a></li></ul></li><li class="dropdown-item"><h4>
          中间件
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/celery/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Celery
</a></li></ul></li><li class="dropdown-item"><h4>
          数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/mysql/" class="nav-link">
  Mysql
</a></li><li class="dropdown-subitem"><a href="/backend/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-subitem"><a href="/backend/mongodb/" class="nav-link">
  Mongodb
</a></li><li class="dropdown-subitem"><a href="/backend/elasticsearch/" class="nav-link">
  Elasticsearch
</a></li></ul></li><li class="dropdown-item"><h4>
          部署
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/uwsgi/" class="nav-link">
  Uwsgi
</a></li><li class="dropdown-subitem"><a href="/backend/gunicorn/" class="nav-link">
  Gunicorn
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DevOps" class="dropdown-title"><span class="title">DevOps</span> <span class="arrow down"></span></button> <button type="button" aria-label="DevOps" class="mobile-dropdown-title"><span class="title">DevOps</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/devops/docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/devops/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/devops/notes/" class="nav-link">
  DevOps笔记
</a></li><li class="dropdown-item"><!----> <a href="/devops/efficiency/" class="nav-link">
  研发效能
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="软能力" class="dropdown-title"><span class="title">软能力</span> <span class="arrow down"></span></button> <button type="button" aria-label="软能力" class="mobile-dropdown-title"><span class="title">软能力</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/softskills/mind/" class="nav-link">
  思考模型
</a></li><li class="dropdown-item"><!----> <a href="/softskills/communication/" class="nav-link">
  沟通能力
</a></li></ul></div></div><div class="nav-item"><a href="/opensource/" class="nav-link">
  开源前哨
</a></div><div class="nav-item"><a href="/memo/" class="nav-link">
  备忘录
</a></div><div class="nav-item"><a href="/interview/" class="nav-link">
  面试指南
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="软件测试体系" class="dropdown-title"><span class="title">软件测试体系</span> <span class="arrow down"></span></button> <button type="button" aria-label="软件测试体系" class="mobile-dropdown-title"><span class="title">软件测试体系</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/qa/basics/" class="nav-link">
  测试基础
</a></li><li class="dropdown-item"><!----> <a href="/qa/automatic/" class="nav-link">
  自动测试
</a></li><li class="dropdown-item"><!----> <a href="/qa/performance/" class="nav-link">
  性能测试
</a></li><li class="dropdown-item"><!----> <a href="/qa/special/" class="nav-link">
  专项测试
</a></li><li class="dropdown-item"><!----> <a href="/qa/security/" class="nav-link">
  安全测试
</a></li><li class="dropdown-item"><!----> <a href="/qa/tool/" class="nav-link">
  测试工具
</a></li><li class="dropdown-item"><!----> <a href="/qa/framework/" class="nav-link">
  测试框架
</a></li><li class="dropdown-item"><!----> <a href="/qa/view/" class="nav-link">
  测试思考
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/basic/network/" class="nav-link">
  计算机网络
</a></li><li class="dropdown-item"><!----> <a href="/basic/os/" class="nav-link">
  操作系统
</a></li><li class="dropdown-item"><!----> <a href="/basic/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/basic/algorithms/" class="nav-link">
  数据结构与算法
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">前端游乐场</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">前端游乐场</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/vue/" class="nav-link">
  VUE
</a></li><li class="dropdown-item"><!----> <a href="/frontend/css/" class="nav-link">
  CSS
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端训练场" class="dropdown-title"><span class="title">后端训练场</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端训练场" class="mobile-dropdown-title"><span class="title">后端训练场</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          编程语言
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/python/" class="nav-link">
  Python
</a></li><li class="dropdown-subitem"><a href="/backend/java/" class="nav-link">
  Java
</a></li></ul></li><li class="dropdown-item"><h4>
          WEB框架
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/django/" class="nav-link">
  Django
</a></li><li class="dropdown-subitem"><a href="/backend/drf/" class="nav-link">
  Django REST Framework
</a></li></ul></li><li class="dropdown-item"><h4>
          中间件
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/celery/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Celery
</a></li></ul></li><li class="dropdown-item"><h4>
          数据库
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/mysql/" class="nav-link">
  Mysql
</a></li><li class="dropdown-subitem"><a href="/backend/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-subitem"><a href="/backend/mongodb/" class="nav-link">
  Mongodb
</a></li><li class="dropdown-subitem"><a href="/backend/elasticsearch/" class="nav-link">
  Elasticsearch
</a></li></ul></li><li class="dropdown-item"><h4>
          部署
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/uwsgi/" class="nav-link">
  Uwsgi
</a></li><li class="dropdown-subitem"><a href="/backend/gunicorn/" class="nav-link">
  Gunicorn
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DevOps" class="dropdown-title"><span class="title">DevOps</span> <span class="arrow down"></span></button> <button type="button" aria-label="DevOps" class="mobile-dropdown-title"><span class="title">DevOps</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/devops/docker/" class="nav-link">
  Docker
</a></li><li class="dropdown-item"><!----> <a href="/devops/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/devops/notes/" class="nav-link">
  DevOps笔记
</a></li><li class="dropdown-item"><!----> <a href="/devops/efficiency/" class="nav-link">
  研发效能
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="软能力" class="dropdown-title"><span class="title">软能力</span> <span class="arrow down"></span></button> <button type="button" aria-label="软能力" class="mobile-dropdown-title"><span class="title">软能力</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/softskills/mind/" class="nav-link">
  思考模型
</a></li><li class="dropdown-item"><!----> <a href="/softskills/communication/" class="nav-link">
  沟通能力
</a></li></ul></div></div><div class="nav-item"><a href="/opensource/" class="nav-link">
  开源前哨
</a></div><div class="nav-item"><a href="/memo/" class="nav-link">
  备忘录
</a></div><div class="nav-item"><a href="/interview/" class="nav-link">
  面试指南
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>目录</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/backend/celery/" aria-current="page" class="active sidebar-link">Celery基础操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/backend/celery/#celery简介" class="sidebar-link">celery简介</a></li><li class="sidebar-sub-header"><a href="/backend/celery/#使用场景" class="sidebar-link">使用场景</a></li><li class="sidebar-sub-header"><a href="/backend/celery/#优点" class="sidebar-link">优点</a></li><li class="sidebar-sub-header"><a href="/backend/celery/#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header"><a href="/backend/celery/#执行异步任务" class="sidebar-link">执行异步任务</a></li><li class="sidebar-sub-header"><a href="/backend/celery/#执行定时任务" class="sidebar-link">执行定时任务</a></li><li class="sidebar-sub-header"><a href="/backend/celery/#在django中使用" class="sidebar-link">在django中使用</a></li><li class="sidebar-sub-header"><a href="/backend/celery/#注意事项" class="sidebar-link">注意事项</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p></p><div class="table-of-contents"><ul><li><a href="#celery简介">celery简介</a></li><li><a href="#使用场景">使用场景</a></li><li><a href="#优点">优点</a></li><li><a href="#安装">安装</a></li><li><a href="#执行异步任务">执行异步任务</a><ul><li><a href="#基本使用">基本使用</a></li><li><a href="#多任务时项目结构">多任务时项目结构</a></li></ul></li><li><a href="#执行定时任务">执行定时任务</a><ul><li><a href="#普通模式">普通模式</a></li><li><a href="#多任务结构">多任务结构</a></li></ul></li><li><a href="#在django中使用">在django中使用</a></li><li><a href="#注意事项">注意事项</a></li></ul></div><p></p> <h2 id="celery简介"><a href="#celery简介" class="header-anchor">#</a> celery简介</h2> <p><img src="/assets/img/celery_d369b6a4c4265225.692ae401.png" alt=""> <img src="/assets/img/celery_20220828123748.60f7094d.jpg" alt=""></p> <ol><li>Celery是一个简单、灵活且可靠的，处理大量消息的分布式系统，专注于实时处理的异步任务队列，同时也支持任务调度</li> <li>Celery的架构由三部分组成，消息中间件（message broker），任务执行单元（worker）和任务执行结果存储（task result store）组成</li> <li><strong>消息中间件</strong>：Celery本身不提供消息服务，但是可以方便的和第三方提供的消息中间件集成。包括RabbitMQ, Redis等等</li> <li><strong>任务执行单元</strong>：Worker是Celery提供的任务执行的单元，worker并发的运行在分布式的系统节点中。</li> <li><strong>任务结果存储</strong>：Task result store用来存储Worker执行的任务的结果，Celery支持以不同方式存储任务的结果，包括<a href="https://baike.baidu.com/item/AMQP/8354716" target="_blank" rel="noopener noreferrer">AMQP<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, redis等</li> <li>另外， Celery还支持不同的并发和序列化的手段
<ul><li><strong>并发</strong>：Prefork, Eventlet, gevent, threads/single threaded</li> <li><strong>序列化</strong>：pickle, json, yaml, msgpack. zlib, bzip2 compression， Cryptographic message signing 等等</li></ul></li></ol> <h2 id="使用场景"><a href="#使用场景" class="header-anchor">#</a> 使用场景</h2> <ol><li>celery是一个强大的 分布式任务队列的异步处理框架，它可以让任务的执行完全脱离主程序，甚至可以被分配到其他主机上运行。我们通常使用它来实现异步任务（async task）和定时任务（crontab)。</li> <li><strong>异步任务</strong>：将耗时操作任务提交给Celery去异步执行，比如发送短信/邮件、消息推送、音视频处理等等</li> <li><strong>定时任务</strong>：定时执行某件事情，比如每天数据统计</li></ol> <h2 id="优点"><a href="#优点" class="header-anchor">#</a> 优点</h2> <ol><li><strong>Simple(简单)</strong> <ul><li>Celery 使用和维护都非常简单，并且不需要配置文件。</li></ul></li> <li><strong>Highly Available（高可用）</strong> <ul><li>woker和client会在网络连接丢失或者失败时，自动进行重试。并且有的brokers 也支持“双主”或者“主从”的方式实现高可用。</li></ul></li> <li><strong>Fast（快速）</strong> <ul><li>单个的Celery进程每分钟可以处理百万级的任务，并且只需要毫秒级的往返延迟（使用 RabbitMQ, librabbitmq, 和优化设置时）</li></ul></li> <li><strong>Flexible（灵活）</strong> <ul><li>Celery几乎每个部分都可以扩展使用，自定义池实现、序列化、压缩方案、日志记录、调度器、消费者、生产者、broker传输等等。</li></ul></li></ol> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code> pip install celery
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="执行异步任务"><a href="#执行异步任务" class="header-anchor">#</a> 执行异步任务</h2> <h3 id="基本使用"><a href="#基本使用" class="header-anchor">#</a> 基本使用</h3> <p>创建异步任务执行文件celery_task.py</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">import</span> celery
<span class="token keyword">import</span> time

backend <span class="token operator">=</span> <span class="token string">'redis://127.0.0.1:6379/1'</span>
broker <span class="token operator">=</span> <span class="token string">'redis://127.0.0.1:6379/2'</span>

cel <span class="token operator">=</span> celery<span class="token punctuation">.</span>Celery<span class="token punctuation">(</span><span class="token string">'celery_demo'</span><span class="token punctuation">,</span> backend<span class="token operator">=</span>backend<span class="token punctuation">,</span> broker<span class="token operator">=</span>broker<span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@cel<span class="token punctuation">.</span>task</span>
<span class="token keyword">def</span> <span class="token function">send_email</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'向</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">发送邮件！'</span></span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'向</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">发送邮件完成！'</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">'ok'</span>


<span class="token decorator annotation punctuation">@cel<span class="token punctuation">.</span>task</span>
<span class="token keyword">def</span> <span class="token function">send_msg</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'向</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">发送信息！'</span></span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'向</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">发送信息完成！'</span></span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">'ok'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>创建执行任务文件produce_task.py</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> celery_task <span class="token keyword">import</span> send_email<span class="token punctuation">,</span> send_msg

result1 <span class="token operator">=</span> send_email<span class="token punctuation">.</span>delay<span class="token punctuation">(</span><span class="token string">'liu'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result1<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>

result2 <span class="token operator">=</span> send_email<span class="token punctuation">.</span>delay<span class="token punctuation">(</span><span class="token string">'lin'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result2<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>

result3 <span class="token operator">=</span> send_msg<span class="token punctuation">.</span>delay<span class="token punctuation">(</span><span class="token string">'yuan'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result3<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>

result4 <span class="token operator">=</span> send_msg<span class="token punctuation">.</span>delay<span class="token punctuation">(</span><span class="token string">'ha'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result4<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>命令行启动</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>celery <span class="token operator">-</span>A celery_task worker <span class="token operator">-</span>l INFO
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>创建查看结果文件result.py</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> celery<span class="token punctuation">.</span>result <span class="token keyword">import</span> AsyncResult
<span class="token keyword">from</span> celery_task <span class="token keyword">import</span> cel

<span class="token comment"># 参数id需要先拿到任务id</span>
async_result <span class="token operator">=</span> AsyncResult<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token string">'88901fa8-c318-4ba2-9428-1fb60c003156'</span><span class="token punctuation">,</span> app<span class="token operator">=</span>cel<span class="token punctuation">)</span>
<span class="token keyword">if</span> async_result<span class="token punctuation">.</span>successful<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> async_result<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token keyword">elif</span> async_result<span class="token punctuation">.</span>failed<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'failed'</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> async_result<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token string">'PENDING'</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'任务等待中'</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> async_result<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token string">'RETRY'</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'任务异常后正在重试'</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> async_result<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token string">'STARTED'</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'任务已经开始被执行'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="多任务时项目结构"><a href="#多任务时项目结构" class="header-anchor">#</a> 多任务时项目结构</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>celeryPro
	celery_tasks
		__init__<span class="token punctuation">.</span>py
		celery<span class="token punctuation">.</span>py
		task_01<span class="token punctuation">.</span>py <span class="token comment"># 任务1</span>
		task_02<span class="token punctuation">.</span>py <span class="token comment"># 任务2</span>
	celery_result<span class="token punctuation">.</span>py <span class="token comment"># 任务结果</span>
	produce_task<span class="token punctuation">.</span>py <span class="token comment"># 执行任务</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>文件<span class="token punctuation">:</span> celery<span class="token punctuation">.</span>py

<span class="token keyword">from</span> celery <span class="token keyword">import</span> Celery

cel <span class="token operator">=</span> Celery<span class="token punctuation">(</span><span class="token string">'celery_demo'</span><span class="token punctuation">,</span>
             broker<span class="token operator">=</span><span class="token string">'redis://127.0.0.1:6379/1'</span><span class="token punctuation">,</span>
             backend<span class="token operator">=</span><span class="token string">'redis://127.0.0.1:6379/2'</span><span class="token punctuation">,</span>
             <span class="token comment"># 包含以下两个任务文件，去相应的py文件中找任务，对多个任务做分类</span>
             include<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'celery_tasks.task01'</span><span class="token punctuation">,</span><span class="token string">'celery_tasks.task02'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 时区</span>
cel<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>timezone <span class="token operator">=</span> <span class="token string">'Asia/Shanghai'</span>
<span class="token comment"># 是否使用UTC</span>
cel<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>enable_utc <span class="token operator">=</span> <span class="token boolean">False</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>文件<span class="token punctuation">:</span> task01<span class="token punctuation">.</span>py
<span class="token keyword">import</span> time
<span class="token keyword">from</span> celery_tasks<span class="token punctuation">.</span>celery <span class="token keyword">import</span> cel


<span class="token decorator annotation punctuation">@cel<span class="token punctuation">.</span>task</span>
<span class="token keyword">def</span> <span class="token function">send_email</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f&quot;完成向</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">发送邮件任务&quot;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>文件<span class="token punctuation">:</span> task02<span class="token punctuation">.</span>py

<span class="token keyword">import</span> time
<span class="token keyword">from</span> celery_tasks<span class="token punctuation">.</span>celery <span class="token keyword">import</span> cel


<span class="token decorator annotation punctuation">@cel<span class="token punctuation">.</span>task</span>
<span class="token keyword">def</span> <span class="token function">send_msg</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f&quot;完成向</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">发送信息任务&quot;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>文件<span class="token punctuation">:</span> produce_task<span class="token punctuation">.</span>py

<span class="token keyword">from</span> celery_tasks<span class="token punctuation">.</span>task01 <span class="token keyword">import</span> send_email
<span class="token keyword">from</span> celery_tasks<span class="token punctuation">.</span>task02 <span class="token keyword">import</span> send_msg

<span class="token comment"># 立即告知celery去执行test_celery任务，并传入一个参数</span>
result <span class="token operator">=</span> send_email<span class="token punctuation">.</span>delay<span class="token punctuation">(</span><span class="token string">'liu'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
result <span class="token operator">=</span> send_msg<span class="token punctuation">.</span>delay<span class="token punctuation">(</span><span class="token string">'lin'</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>文件<span class="token punctuation">:</span> celery_result<span class="token punctuation">.</span>py

<span class="token keyword">from</span> celery<span class="token punctuation">.</span>result <span class="token keyword">import</span> AsyncResult
<span class="token keyword">from</span> celery_tasks<span class="token punctuation">.</span>celery <span class="token keyword">import</span> cel

<span class="token comment"># Django中可以使用django_celery_results，但是django_celery_results查不到celery_taskmeta表中的数据，只能查询安装了该库以后的任务。以下用法更简洁</span>
async_result <span class="token operator">=</span> AsyncResult<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token string">&quot;2c25c916-e57c-496e-95c5-fb1c787d11ec&quot;</span><span class="token punctuation">,</span> app<span class="token operator">=</span>cel<span class="token punctuation">)</span>

<span class="token keyword">if</span> async_result<span class="token punctuation">.</span>successful<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    result <span class="token operator">=</span> async_result<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    <span class="token comment"># result.forget() # 将结果删除,执行完成，结果不会自动删除</span>
    <span class="token comment"># async.revoke(terminate=True)  # 无论现在是什么时候，都要终止</span>
    <span class="token comment"># async.revoke(terminate=False) # 如果任务还没有开始执行呢，那么就可以终止。</span>
<span class="token keyword">elif</span> async_result<span class="token punctuation">.</span>failed<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'执行失败'</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> async_result<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token string">'PENDING'</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'任务等待中被执行'</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> async_result<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token string">'RETRY'</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'任务异常后正在重试'</span><span class="token punctuation">)</span>
<span class="token keyword">elif</span> async_result<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token string">'STARTED'</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'任务已经开始被执行'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="执行定时任务"><a href="#执行定时任务" class="header-anchor">#</a> 执行定时任务</h2> <h3 id="普通模式"><a href="#普通模式" class="header-anchor">#</a> 普通模式</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token builtin">file</span><span class="token punctuation">:</span> celery_task<span class="token punctuation">.</span>py

<span class="token keyword">import</span> time
<span class="token keyword">from</span> celery_tasks<span class="token punctuation">.</span>celery <span class="token keyword">import</span> cel

<span class="token decorator annotation punctuation">@cel<span class="token punctuation">.</span>task</span>
<span class="token keyword">def</span> <span class="token function">send_email</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">:</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f&quot;完成向</span><span class="token interpolation"><span class="token punctuation">{</span>name<span class="token punctuation">}</span></span><span class="token string">发送邮件任务&quot;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>文件<span class="token punctuation">:</span> produce_task<span class="token punctuation">.</span>py

<span class="token keyword">from</span> celery_tasks<span class="token punctuation">.</span>task01 <span class="token keyword">import</span> send_email
<span class="token keyword">from</span> celery_tasks<span class="token punctuation">.</span>task02 <span class="token keyword">import</span> send_msg
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime<span class="token punctuation">,</span> timedelta

<span class="token comment"># 方式一</span>
<span class="token comment"># v1 = datetime(2022, 5, 25, 21, 18, 0)</span>
<span class="token comment"># print(v1)</span>
<span class="token comment"># v2 = datetime.utcfromtimestamp(v1.timestamp())</span>
<span class="token comment"># print(v2)</span>
<span class="token comment"># result = send_email.apply_async(args=['lin'], eta=v2)</span>

<span class="token comment"># 方式二</span>
ctime <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 默认使用utc时间</span>
utc_time <span class="token operator">=</span> datetime<span class="token punctuation">.</span>utcfromtimestamp<span class="token punctuation">(</span>ctime<span class="token punctuation">.</span>timestamp<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
time_delay <span class="token operator">=</span> timedelta<span class="token punctuation">(</span>seconds<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
task_time <span class="token operator">=</span> utc_time <span class="token operator">+</span> time_delay
<span class="token keyword">print</span><span class="token punctuation">(</span>task_time<span class="token punctuation">)</span>
result <span class="token operator">=</span> send_email<span class="token punctuation">.</span>apply_async<span class="token punctuation">(</span>args<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'lin'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> eta<span class="token operator">=</span>task_time<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>celery <span class="token operator">-</span>A tmp_task worker <span class="token operator">-</span>l INFO
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>然后执行produce_task.py</li></ul> <h3 id="多任务结构"><a href="#多任务结构" class="header-anchor">#</a> 多任务结构</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>文件<span class="token punctuation">:</span> celery<span class="token punctuation">.</span>py

<span class="token keyword">from</span> celery <span class="token keyword">import</span> Celery
<span class="token keyword">from</span> celery<span class="token punctuation">.</span>schedules <span class="token keyword">import</span> crontab
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> timedelta

cel <span class="token operator">=</span> Celery<span class="token punctuation">(</span><span class="token string">'celery_demo'</span><span class="token punctuation">,</span>
             broker<span class="token operator">=</span><span class="token string">'redis://127.0.0.1:6379/1'</span><span class="token punctuation">,</span>
             backend<span class="token operator">=</span><span class="token string">'redis://127.0.0.1:6379/2'</span><span class="token punctuation">,</span>
             <span class="token comment"># 包含以下两个任务文件，去相应的py文件中找任务，对多个任务做分类</span>
             include<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'celery_tasks.task01'</span><span class="token punctuation">,</span><span class="token string">'celery_tasks.task02'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 时区</span>
cel<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>timezone <span class="token operator">=</span> <span class="token string">'Asia/Shanghai'</span>
<span class="token comment"># 是否使用UTC</span>
cel<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>enable_utc <span class="token operator">=</span> <span class="token boolean">False</span>

cel<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>beat_schedule <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'add-every-5-seconds'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">'task'</span><span class="token punctuation">:</span> <span class="token string">'celery_tasks.task01.send_email'</span><span class="token punctuation">,</span>
        <span class="token comment"># 'schedule': 1.0,</span>
        <span class="token comment"># 'schedule': crontab(minute=&quot;*/1&quot;),</span>
        <span class="token string">'schedule'</span><span class="token punctuation">:</span> timedelta<span class="token punctuation">(</span>seconds<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">'args'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">'张三'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">'add-every-8-seconds'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">'task'</span><span class="token punctuation">:</span> <span class="token string">'celery_tasks.task02.send_msg'</span><span class="token punctuation">,</span>
        <span class="token string">'schedule'</span><span class="token punctuation">:</span> timedelta<span class="token punctuation">(</span>seconds<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">'args'</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">'李四'</span><span class="token punctuation">,</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>celery <span class="token operator">-</span>A celery_tasks worker <span class="token operator">-</span>l INFO
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>celery  <span class="token operator">-</span>A celery_tasks beat
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="在django中使用"><a href="#在django中使用" class="header-anchor">#</a> 在django中使用</h2> <p>结构如下：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>├─drfdemo
│  │  asgi<span class="token punctuation">.</span>py
│  │  authentication<span class="token punctuation">.</span>py
│  │  exceptions<span class="token punctuation">.</span>py
│  │  permissions<span class="token punctuation">.</span>py
│  │  settings<span class="token punctuation">.</span>py
│  │  urls<span class="token punctuation">.</span>py
│  │  wsgi<span class="token punctuation">.</span>py
│  │  __init__<span class="token punctuation">.</span>py
│
├─mycelery
│  │  config<span class="token punctuation">.</span>py
│  │  main<span class="token punctuation">.</span>py
│  │  settings<span class="token punctuation">.</span>py
│  │  __init__<span class="token punctuation">.</span>py
│  │
│  ├─email
│  │  │  tasks<span class="token punctuation">.</span>py
│  │  │  __init__<span class="token punctuation">.</span>py
│  ├─sms
│  │  │  tasks<span class="token punctuation">.</span>py
│  │  │  __init__<span class="token punctuation">.</span>py
│
├─opt
│  │  admin<span class="token punctuation">.</span>py
│  │  apps<span class="token punctuation">.</span>py
│  │  models<span class="token punctuation">.</span>py
│  │  tests<span class="token punctuation">.</span>py
│  │  urls<span class="token punctuation">.</span>py
│  │  views<span class="token punctuation">.</span>py
│  │  __init__<span class="token punctuation">.</span>py
│  │
│  ├─migrations
│  │  │  __init__<span class="token punctuation">.</span>py
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>文件<span class="token punctuation">:</span> config<span class="token punctuation">.</span>py
broker_url <span class="token operator">=</span> <span class="token string">'redis://127.0.0.1:6379/15'</span>
result_backend <span class="token operator">=</span> <span class="token string">'redis://127.0.0.1:6379/14'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>文件<span class="token punctuation">:</span> main<span class="token punctuation">.</span>py

<span class="token comment"># 主程序</span>
<span class="token keyword">import</span> os
<span class="token keyword">from</span> celery <span class="token keyword">import</span> Celery

<span class="token comment"># 创建celery实例对象</span>
app <span class="token operator">=</span> Celery<span class="token punctuation">(</span><span class="token string">&quot;celery_demo&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># 把celery和django进行组合，识别和加载django的配置文件</span>
os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span><span class="token string">'DJANGO_SETTINGS_MODULE'</span><span class="token punctuation">,</span><span class="token string">'mycelery.settings'</span><span class="token punctuation">)</span>

<span class="token comment"># 通过app对象加载配置</span>
app<span class="token punctuation">.</span>config_from_object<span class="token punctuation">(</span><span class="token string">&quot;mycelery.config&quot;</span><span class="token punctuation">)</span>

<span class="token comment"># 加载任务</span>
<span class="token comment"># 参数必须必须是一个列表，里面的每一个任务都是任务的路径名称</span>
<span class="token comment"># app.autodiscover_tasks([&quot;任务1&quot;,&quot;任务2&quot;])</span>
app<span class="token punctuation">.</span>autodiscover_tasks<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;mycelery.sms&quot;</span><span class="token punctuation">,</span> <span class="token string">'mycelery.email'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment"># 启动Celery的命令</span>
<span class="token comment"># 强烈建议切换目录到mycelery根目录下启动</span>
<span class="token comment"># celery -A mycelery.main worker --loglevel=info</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>文件<span class="token punctuation">:</span> email<span class="token operator">/</span>tasks<span class="token punctuation">.</span>py
<span class="token comment"># celery的任务必须写在tasks.py的文件中，别的文件名称不识别!!!</span>
<span class="token keyword">from</span> mycelery<span class="token punctuation">.</span>main <span class="token keyword">import</span> app
<span class="token keyword">import</span> time

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>task</span>  <span class="token comment"># name表示设置任务的名称，如果不填写，则默认使用函数名做为任务名</span>
<span class="token keyword">def</span> <span class="token function">send_sms</span><span class="token punctuation">(</span>mobile<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">&quot;&quot;&quot;发送短信&quot;&quot;&quot;</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;向手机号%s发送短信成功!&quot;</span> <span class="token operator">%</span> mobile<span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">&quot;send_sms OK&quot;</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>task</span>
<span class="token keyword">def</span> <span class="token function">send_sms2</span><span class="token punctuation">(</span>mobile<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;向手机号%s发送短信成功!&quot;</span> <span class="token operator">%</span> mobile<span class="token punctuation">)</span>
    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">&quot;send_sms2 OK&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code>文件：views<span class="token punctuation">.</span>py

<span class="token keyword">from</span> mycelery<span class="token punctuation">.</span>email<span class="token punctuation">.</span>tasks <span class="token keyword">import</span> send_sms<span class="token punctuation">,</span> send_sms2
<span class="token keyword">from</span> datetime <span class="token keyword">import</span> timedelta<span class="token punctuation">,</span> datetime

<span class="token keyword">def</span> <span class="token function">celery_demo</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    send_sms<span class="token punctuation">.</span>delay<span class="token punctuation">(</span><span class="token string">&quot;110&quot;</span><span class="token punctuation">)</span>
    send_sms2<span class="token punctuation">.</span>delay<span class="token punctuation">(</span><span class="token string">&quot;119&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span>

	ctime <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># 默认用utc时间</span>
    utc_ctime <span class="token operator">=</span> datetime<span class="token punctuation">.</span>utcfromtimestamp<span class="token punctuation">(</span>ctime<span class="token punctuation">.</span>timestamp<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    time_delay <span class="token operator">=</span> timedelta<span class="token punctuation">(</span>seconds<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
    task_time <span class="token operator">=</span> utc_ctime <span class="token operator">+</span> time_delay
    result <span class="token operator">=</span> send_sms<span class="token punctuation">.</span>apply_async<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;911&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> eta<span class="token operator">=</span>task_time<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token builtin">id</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code>celery -A mycelery.main worker -l INFO
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="注意事项"><a href="#注意事项" class="header-anchor">#</a> 注意事项</h2> <ol><li>同时使用异步任务和定时任务，更简单的启动方式：celery -A file worker -b -l info，可同时启动worker和beat</li> <li>celery不能用root用户启动，需要在配置文件添加platforms.C_FORCE_ROOT=True</li> <li>celery在长时间运行后可能出现内存泄露，需要配置CELERYD_TASKS_PER_CHILD = n，表示每个worker执行n个任务杀掉子进程再启动新的子进程</li> <li>celery配置文件建议在django配置文件中配置，参考<a href="https://docs.celeryproject.org/en/stable/userguide/configuration.html#std-setting-result_expires" target="_blank" rel="noopener noreferrer">https://docs.celeryproject.org/en/stable/userguide/configuration.html#std-setting-result_expires<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>一个无限期阻塞的任务会使得工作单元无法再做其他事情，建议给任务设置超时时间</li> <li>使用celery定义任务时，避免在一个任务中调用另一个异步任务，容易造成阻塞</li> <li>使用@shared_task装饰器能让我们避免对某个项目名对应Celery实例的依赖，使app的可移植性更强</li> <li>如果你变换了时区timezone，比如从'UTC'变成了'Asia/Shanghai'，需重置周期性任务</li> <li>要调用self这个参数，定义任务时必须设置bind=True</li> <li>不同任务交由不同Queue处理，不同的任务所需要的资源和时间不一样的，为了防止一些非常占用资源或耗时的任务阻塞任务队列导致一些简单任务也无法执行</li> <li>如果你不在意任务的返回结果，可以设置 ignore_result 选项，因为存储结果耗费时间和资源。你还可以可以通过 task_ignore_result 设置全局忽略任务结果</li> <li>避免启动同步子任务，让一个任务等待另外一个任务的返回结果是很低效的，并且如果工作单元池被耗尽的话这将会导致死锁</li></ol> <ul><li>参考</li> <li><a href="https://docs.celeryq.dev/en/stable/" target="_blank" rel="noopener noreferrer">celery官网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.celeryq.dev/en/stable/django/first-steps-with-django.html#using-celery-with-django" target="_blank" rel="noopener noreferrer">在Django中使用celery<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://pypi.org/project/celery/" target="_blank" rel="noopener noreferrer">https://pypi.org/project/celery/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://mp.weixin.qq.com/s/m-lKF_D440bOU9nqszw6Mw" target="_blank" rel="noopener noreferrer">https://mp.weixin.qq.com/s/m-lKF_D440bOU9nqszw6Mw<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.dd60fddf.js" defer></script><script src="/assets/js/2.1d799614.js" defer></script><script src="/assets/js/18.bb46f976.js" defer></script>
  </body>
</html>
